{"version":3,"file":"default-src_app_pages_vehicle-linking_vehicle-linking_page_ts-es2015.js","mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAMoC;AAQmB;AAKtB;AAIY;AAEK;AAC3B;AAEoC;AACiB;AAOb;AACL;AACE;AAEiC;;;;;;;;;;;;;;;;;;ICtCzF,0EAA2E;IACzE,sEAAI;IAAA,wDAAa;IAAA,6DAAK;IACtB,0EAA8B;IAC5B,6EAA0C;IAC1C,0EAAmE;IACrE,6DAAM;IACN,wEAAwB;IAAA,wDAAc;IAAA,6DAAI;IAC1C,wEAAuB;IAAA,wDAAc;IAAA,6DAAI;IACzC,0EAAwB;IAAA,uGAA0C;IAAA,6DAAI;IACtE,iFAAoC;IAClC,4EAAS;IACP,gFAAgD;IAAnB,wTAAkB;IAC7C,0EAAuC;IAAA,mEAAM;IAAA,6DAAI;IACnD,6DAAU;IACZ,6DAAU;IACZ,6DAAW;IACb,6DAAM;;;IAhBmB,sFAAqB;IACxC,2DAAa;IAAb,2FAAa;IAKO,2DAAc;IAAd,mFAAc;IACf,2DAAc;IAAd,mFAAc;IAE3B,2DAAyB;IAAzB,0FAAyB;;;;IASrC,0EAA4E;IAC1E,sEAAI;IAAA,+EAAmB;IAAA,6DAAK;IAC5B,0EAA8B;IAC5B,8EAAyD;IAC3D,6DAAM;IACN,yEAA6B;IAAA,yEAAa;IAAA,6DAAI;IAC9C,4EAAU;IACR,2EAAS;IACP,+EAAgD;IAAnB,uTAAkB;IAC7C,0EAAuC;IAAA,mEAAM;IAAA,6DAAI;IACnD,6DAAU;IACZ,6DAAU;IACZ,6DAAW;IACb,6DAAM;;;IAbmB,uFAAsB;;;;IAgB7C,kFAAiH;IAA/B,qZAA8B;IAAC,wDAAsB;IAAA,6DAAa;;;IAAnC,2DAAsB;IAAtB,uFAAsB;;;;IAFzI,2EAA0F;IACxF,0EAAiB;IAAA,gFAAoB;IAAA,6DAAK;IAC1C,oIAAoJ;IACpJ,4EAAU;IACR,2EAAS;IACP,+EAAgD;IAAnB,0TAAkB;IAC7C,yEAAmC;IAAA,kEAAM;IAAA,6DAAI;IAC/C,6DAAU;IACZ,6DAAU;IACZ,6DAAW;IACb,6DAAM;;;IARkE,2DAAU;IAAV,oFAAU;;ADa/E,MAAM,kBAAmB,SAAQ,yEAAc;IA+BpD,YACU,eAAgC,EAChC,gBAAkC,EAClC,MAAqB,EACrB,iBAAoC,EACpC,WAAgC,EAChC,QAAkB,EAClB,QAAkB,EAClB,IAAY,EACZ,UAAsB,EACtB,kBAAsC,EACtC,aAAoC,EACpC,YAAoB,EACpB,cAA8B,EAC9B,cAAiC,EACjC,cAAsC,EACtC,GAAQ;QAEhB,KAAK,CAAC,oBAAoB,CAAC,CAAC;QAjBpB,oBAAe,GAAf,eAAe,CAAiB;QAChC,qBAAgB,GAAhB,gBAAgB,CAAkB;QAClC,WAAM,GAAN,MAAM,CAAe;QACrB,sBAAiB,GAAjB,iBAAiB,CAAmB;QACpC,gBAAW,GAAX,WAAW,CAAqB;QAChC,aAAQ,GAAR,QAAQ,CAAU;QAClB,aAAQ,GAAR,QAAQ,CAAU;QAClB,SAAI,GAAJ,IAAI,CAAQ;QACZ,eAAU,GAAV,UAAU,CAAY;QACtB,uBAAkB,GAAlB,kBAAkB,CAAoB;QACtC,kBAAa,GAAb,aAAa,CAAuB;QACpC,iBAAY,GAAZ,YAAY,CAAQ;QACpB,mBAAc,GAAd,cAAc,CAAgB;QAC9B,mBAAc,GAAd,cAAc,CAAmB;QACjC,mBAAc,GAAd,cAAc,CAAwB;QACtC,QAAG,GAAH,GAAG,CAAK;;QA9ClB,UAAK,GAAG,kBAAkB,CAAC;QAC3B,aAAQ,GAAG,KAAK,CAAC;QAGjB,eAAU,GAAG,IAAI,CAAC;QAClB,uBAAkB,GAAG,KAAK,CAAC;QAC3B,UAAK,GAAG,CAAC,CAAC;QAEV,yBAAoB,GAAG,KAAK,CAAC;QAC7B,YAAO,GAAG,CAAC,CAAC;QACZ,kBAAa,GAAG,KAAK,CAAC;QACtB,sBAAiB,GAAG,KAAK,CAAC;QAC1B,UAAK,GAAG,KAAK,CAAC;QACd,WAAM,GAAG,eAAe,CAAC;QACjB,cAAS,GAAG,KAAK,CAAC;QAC1B,iBAAY,GAAG,KAAK,CAAC;QACrB,mBAAc,GAAG,KAAK,CAAC;QACvB,aAAQ,GAAG,EAAE,CAAC;QACd,aAAQ,GAAG,EAAE,CAAC;QAGd,6BAAwB,GAAG,EAAE,CAAC;QAGtB,wBAAmB,GAAG,KAAK,CAAC;QAG5B,oBAAe,GAAG,IAAI,CAAC;QAC/B,kDAA2B;QAC3B,4BAAuB,GAAG,IAAI,CAAC;IAoB/B,CAAC;IAED,SAAS,CAAC,MAAM,EAAE,MAAM,GAAG,EAAE;QAC3B,OAAO,CAAC,GAAG,CAAC,+CAA+C,EAAE,MAAM,CAAC;QACpE,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,GAAG,EAAE;YACjB,IAAI,MAAM,IAAI,IAAI,EAAE;gBAClB,IAAI,CAAC,UAAU,GAAG,MAAM,CAAC;gBACzB,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,IAAI,CAAC,UAAU,GAAG,KAAK,GAAG,MAAM,CAAC,CAAC;aACrD;YACD,IAAI,CAAC,UAAU,GAAG,MAAM,CAAC;QAC3B,CAAC,CAAC,CAAC;IACL,CAAC;IAED,YAAY,CAAC,MAAe;QAC1B,OAAO,CAAC,GAAG,CAAC,kDAAkD,EAAE,MAAM,CAAC;QACvE,IAAI,CAAC,YAAY,CAAC,OAAO,CAAC,+FAA8B,EAAE,MAAM,CAAC,CAAC;QAClE,IAAI,CAAC,UAAU,GAAG,KAAK,CAAC;QACxB,IAAI,CAAC,kBAAkB,GAAG,KAAK,CAAC;QAChC,6BAA6B;QAC7B,IAAI,CAAC,MAAM,CAAC,aAAa,CAAC,IAAI,CAAC,cAAc,CAAC,CAAC;IACjD,CAAC;IAEK,gBAAgB;;YACpB,IAAI,CAAC,kBAAkB,GAAG,KAAK,CAAC;YAChC,IAAI,CAAC,UAAU,GAAG,KAAK,CAAC;YACxB,IAAI,CAAC,YAAY,GAAG,KAAK,CAAC;YAC1B,IAAI,CAAC,cAAc,GAAG,KAAK,CAAC;YAC5B,IAAI,CAAC,mBAAmB,GAAG,KAAK,CAAC;YACjC,IAAI,CAAC,wBAAwB,GAAG,EAAE,CAAC;YACnC,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC;YACxB,IAAI,CAAC,YAAY,GAAG,kFAAuB,CAAC;YAC5C,IAAI,CAAC,aAAa,GAAG,IAAI,CAAC,aAAa,CAAC,gBAAgB,EAAE,CAAC;YAC3D,IAAI,CAAC,gBAAgB,GAAG,gEAAW,CAAC,wFAAmC,CAAC,CAAC;YACzE,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC,MAAM,CAAC,qBAAqB,CAC/C,IAAI,CAAC,iBAAiB,CAAC,aAAa,CAAC,UAAU,CAAC,CACjD,CAAC;YACF,IAAI,IAAI,CAAC,QAAQ,EAAE;gBACjB,IAAI,CAAC,KAAK,GAAG,oBAAoB,CAAC;gBAClC,IAAI,CAAC,MAAM,GAAG,EAAE,CAAC;aAClB;iBAAM;gBACL,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC;gBACvB,IAAI,CAAC,KAAK,GAAG,kBAAkB,CAAC;gBAChC,IAAI,CAAC,MAAM,GAAG,eAAe,CAAC;gBAC9B,IAAI,CAAC,YAAY,CAAC,SAAS,CACzB,yFAAwB,EACxB,CAAC,MAAe,EAAE,EAAE;oBAClB,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,aAAa,EAAE,MAAM,CAAC,CAAC;oBACzC,IAAI,CAAC,QAAQ,GAAG,MAAM,CAAC,EAAE,CAAC;oBAC1B,IAAI,CAAC,QAAQ,GAAG,MAAM,CAAC,IAAI,CAAC;oBAC5B,IAAI,CAAC,KAAK,GAAG,SAAS,CAAC;oBACvB,IAAI,CAAC,SAAS,CACZ,MAAM,CAAC,IAAI,GAAG,qBAAqB,EACnC,uBAAuB,CACxB,CAAC;oBACF,IAAI,CAAC,UAAU,GAAG,KAAK,CAAC;oBACxB,IAAI,IAAI,CAAC,eAAe,EAAE;wBACxB,YAAY,CAAC,IAAI,CAAC,eAAe,CAAC,CAAC;wBACnC,IAAI,CAAC,eAAe,GAAG,IAAI,CAAC;qBAC7B;oBACD,IAAI,IAAI,CAAC,uBAAuB,EAAE;wBAChC,aAAa,CAAC,IAAI,CAAC,uBAAuB,CAAC,CAAC;wBAC5C,IAAI,CAAC,uBAAuB,GAAG,IAAI,CAAC;qBACrC;oBACD,IAAI,CAAC,SAAS,EAAE,CAAC;gBACnB,CAAC,CACF,CAAC;gBACF,IAAI,GAAG,GAAG,IAAI,CAAC;gBACf,GAAG,CAAC,OAAO,GAAG,EAAE,CAAC;gBACjB,IAAI,CAAC,YAAY,CAAC,SAAS,CACzB,4FAA2B,EAC3B,CAAC,MAAe,EAAE,EAAE;oBAClB,IAAI,CAAC,GAAG,CAAC,OAAO,EAAE;wBAChB,GAAG,CAAC,OAAO,GAAG,EAAE,CAAC;qBAClB;oBACD,IAAI,GAAG,CAAC,OAAO,CAAC,SAAS,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC,EAAE,KAAK,MAAM,CAAC,EAAE,CAAC,GAAG,CAAC,EAAE;wBACxD,GAAG,CAAC,OAAO,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;qBAC1B;gBACH,CAAC,CACF,CAAC;gBACF,GAAG,CAAC,uBAAuB,GAAG,WAAW,CAAC,GAAG,EAAE;oBAC7C,IAAI,GAAG,CAAC,UAAU,EAAE;wBAClB,IAAI,GAAG,CAAC,OAAO,CAAC,MAAM,GAAG,CAAC,EAAE;4BAC1B,IAAI,IAAI,CAAC,uBAAuB,EAAE;gCAChC,aAAa,CAAC,IAAI,CAAC,uBAAuB,CAAC,CAAC;gCAC5C,IAAI,CAAC,uBAAuB,GAAG,IAAI,CAAC;6BACrC;4BACD,GAAG,CAAC,YAAY,CAAC,WAAW,CAAC,4FAA2B,CAAC,CAAC;4BAC1D,GAAG,CAAC,UAAU,GAAG,KAAK,CAAC;4BACvB,YAAY,CAAC,GAAG,CAAC,eAAe,CAAC,CAAC;4BAClC,GAAG,CAAC,eAAe,GAAG,IAAI,CAAC;4BAC3B,IAAI,mFAAoB,EAAE;gCACxB,OAAO,CAAC,GAAG,CAAC,wBAAwB,CAAC,CAAC;gCACtC,GAAG,CAAC,WAAW,CAAC,QAAQ,EAAE,CAAC;6BAC5B;4BACD,IAAI,GAAG,CAAC,OAAO,CAAC,MAAM,GAAG,CAAC,EAAE;gCAC1B,GAAG,CAAC,kBAAkB,GAAG,IAAI,CAAC;6BAC/B;iCAAM;gCACL,GAAG,CAAC,YAAY,CAAC,GAAG,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,CAAC;6BAClC;4BACD,GAAG,CAAC,MAAM,CAAC,aAAa,CAAC,GAAG,CAAC,cAAc,CAAC,CAAC;yBAC9C;qBACF;yBAAM;wBACL,aAAa,CAAC,GAAG,CAAC,uBAAuB,CAAC,CAAC;wBAC3C,GAAG,CAAC,uBAAuB,GAAG,IAAI,CAAC;qBACpC;gBACH,CAAC,EAAE,yFAAiC,CAAC,CAAC;gBAEtC,IAAI,CAAC,iBAAiB,GAAG,KAAK,CAAC;gBAC/B,IAAI,CAAC,YAAY,CAAC,SAAS,CACzB,mFAA8B,EAC9B,CAAO,QAAQ,EAAE,EAAE,CAAC;oBAClB,IAAI,CAAC,YAAY,CAAC,WAAW,CAAC,mFAA8B,CAAC,CAAC;oBAC9D,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,QAAQ,CAAC,CAAC;oBAC5B,IAAI,CAAC,QAAQ,GAAG,QAAQ,CAAC;oBACzB,IAAI,IAAI,CAAC,QAAQ,EAAE;wBACjB,YAAY,CAAC,OAAO,CAClB,qFAA4B,EAC5B,IAAI,CAAC,QAAQ,CAAC,IAAI,CACnB,CAAC;qBACH;gBACH,CAAC,EACF,CAAC;gBAEF,IAAI,CAAC,eAAe,GAAG,UAAU,CAAC,GAAS,EAAE,CAAC;oBAC5C,IAAI,CAAC,IAAI,CAAC,WAAW,EAAE;wBACrB,IAAI,CAAC,iBAAiB;6BACnB,IAAI,CAAC,kFAA0B,CAAC;6BAChC,IAAI,CAAC,GAAS,EAAE,CAAC;4BAChB,IAAI,mFAAoB,EAAE;gCACxB,OAAO,CAAC,GAAG,CAAC,wBAAwB,CAAC,CAAC;gCACtC,IAAI,CAAC,GAAG,CAAC,QAAQ,EAAE,CAAC;6BACrB;4BACD,MAAM,IAAI,CAAC,gBAAgB,CAAC,UAAU,CAAC,IAAI,EAAE,IAAI,CAAC,QAAQ,CAAC,CAAC;wBAC9D,CAAC,EAAC;qBACL;gBACH,CAAC,GAAE,wFAAgC,CAAC,CAAC;aACtC;YACD,OAAO,CAAC,GAAG,CAAC,qEAAqE,CAAC,CAAC;QACrF,CAAC;KAAA;IAEK,eAAe;;YACnB,IAAI,CAAC,YAAY,CAAC,SAAS,CAAC,2FAA0B,EAAE,CAAC,GAAG,EAAE,EAAE;gBAC9D,IAAI,IAAI,GAAG,iDAAK,CAAC,GAAG,EAAE,MAAM,CAAC,CAAC;gBAC9B,IAAI,MAAM,GAAG,iDAAK,CAAC,GAAG,EAAE,QAAQ,CAAC,CAAC;gBAClC,IAAI,CAAC,SAAS,CAAC,MAAM,EAAE,IAAI,CAAC,CAAC;YAC/B,CAAC,CAAC,CAAC;YACH,6BAA6B;YAC7B,gBAAgB;YAChB,IAAI,WAAW,GAAG,MAAM,IAAI,CAAC,MAAM,CAAC,yBAAyB,EAAE,CAAC;YAChE,IAAI,CAAC,WAAW,EAAE;gBAChB,IAAI,mFAAoB,IAAI,CAAC,0FAA2B,CAAC,EAAE,CAAC,EAAE;oBAC5D,IAAI,CAAC,MAAM,CAAC,OAAO,CACjB,0EAA0E,EAC1E,yBAAyB,EACzB,GAAS,EAAE,CAAC;wBACV,WAAW,GAAG,MAAM,IAAI,CAAC,UAAU,CAAC,iBAAiB,CAAC,IAAI,CAAC,CAAC;wBAC5D,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,eAAe,EAAE,WAAW,CAAC,CAAC;wBAChD,IAAI,WAAW,EAAE;4BACf,IAAI,CAAC,YAAY,EAAE,CAAC;yBACrB;6BAAM;4BACL,IAAI,CAAC,MAAM,CAAC,MAAM,EAAE,CAAC;yBACtB;oBACH,CAAC,GACD,GAAG,EAAE;wBACH,IAAI,CAAC,MAAM,CAAC,MAAM,EAAE,CAAC;oBACvB,CAAC,EACD,mBAAmB,EACnB,QAAQ,CACT,CAAC;iBACH;qBAAM;oBACL,IAAI,CAAC,MAAM,CAAC,OAAO,CACjB,+FAA+F,EAC/F,yBAAyB,EACzB,GAAS,EAAE,CAAC;wBACV,IAAI,mFAAoB,EAAE;4BACxB,IAAI,CAAC,UAAU,CAAC,yBAAyB,EAAE,CAAC;yBAC7C;6BAAM;4BACL,IAAI,CAAC,kBAAkB,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC,KAAK,CAAC,CAAC,EAAE,EAAE,EAAE;;gCACpD,UAAI,CAAC,MAAM,0CAAE,IAAI,CAAC,uCAAuC,EAAE,EAAE,CAAC,CAAC;4BACjE,CAAC,CAAC,CAAC;yBACJ;oBACH,CAAC,GACD,GAAG,EAAE;wBACH,IAAI,CAAC,MAAM,CAAC,MAAM,EAAE,CAAC;oBACvB,CAAC,EACD,gBAAgB,EAChB,QAAQ,CACT,CAAC;iBACH;aACF;iBAAM;gBACL,IAAI,CAAC,YAAY,EAAE,CAAC;aACrB;QACH,CAAC;KAAA;IAEK,YAAY;;YAChB,OAAO,CAAC,GAAG,CAAC,iBAAiB,EAAE,IAAI,CAAC,QAAQ,CAAC,CAAC;YAC9C,IAAI,IAAI,CAAC,QAAQ,EAAE;gBACjB,IAAI,CAAC,iBAAiB,GAAG,IAAI,CAAC;gBAC9B,IAAI,CAAC,SAAS,CAAC,EAAE,EAAE,2BAA2B,CAAC,CAAC;gBAChD,OAAO,MAAM,IAAI,CAAC,cAAc,CAC9B,IAAI,CAAC,gBAAgB,CAAC,eAAe,CAAC,GAAG,CAC1C,CAAC;aACH;iBAAM;gBACL,OAAO,MAAM,mEAAI,yEAAgB,MAApB,IAAI,CAAkB,CAAC;aACrC;QACH,CAAC;KAAA;IAOK,mBAAmB,CACvB,WAA4B,EAC5B,YAA0B;;YAE1B,IAAI,CAAC,SAAS,CAAC,EAAE,EAAE,oBAAoB,CAAC,CAAC;YACzC,IAAI,GAAG,GAAG,IAAI,CAAC;YACf,IAAI,GAAG,CAAC,YAAY,EAAE;gBACpB,OAAO;aACR;YACD,GAAG,CAAC,aAAa,CAAC,iBAAiB,CAAC,GAAG,CAAC,aAAa,CAAC,CAAC;YAEvD,GAAG,CAAC,cAAc,GAAG,IAAI,CAAC;YAC1B,MAAM,GAAG,CAAC,MAAM,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC;YAC7B,MAAM,GAAG,CAAC,YAAY,CAAC,WAAW,EAAE,YAAY,CAAC,CAAC;QACpD,CAAC;KAAA;IAED,kBAAkB;QAChB,IAAI,CAAC,oBAAoB,GAAG,IAAI,CAAC;QACjC,IAAI,CAAC,cAAc,GAAG,KAAK,CAAC;QAC5B,IAAI,CAAC,YAAY,GAAG,IAAI,CAAC;QACzB,IAAI,CAAC,MAAM,CAAC,OAAO,CACjB,IAAI,CAAC,wBAAwB,EAC7B,EAAE,EACF,GAAS,EAAE,CAAC;YACV,IAAI,CAAC,YAAY,GAAG,KAAK,CAAC;YAC1B,MAAM,IAAI,CAAC,YAAY,CAAC,IAAI,CAAC,WAAW,EAAE,IAAI,CAAC,YAAY,CAAC,CAAC;QAC/D,CAAC,GACD,GAAG,EAAE;YACH,IAAI,CAAC,MAAM,CAAC,IAAI,EAAE,IAAI,CAAC,CAAC;QAC1B,CAAC,EACD,WAAW,EACX,QAAQ,CACT,CAAC;IACJ,CAAC;IAEK,YAAY,CAAC,WAA4B,EAAE,YAA0B;;YACzE,IAAI,GAAG,GAAG,IAAI,CAAC;YACf,IAAI;gBACF,GAAG,CAAC,cAAc,GAAG,IAAI,CAAC;gBAC1B,GAAG,CAAC,iBAAiB,GAAG,KAAK,CAAC;gBAC9B,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,iBAAiB,CAAC,CAAC;gBACrC,IAAI,CAAC,WAAW,CAAC,OAAO,EAAE;oBACxB,WAAW,CAAC,OAAO,GAAG,GAAG,CAAC,aAAa,CAAC,OAAO,CAAC;iBACjD;gBACD,IAAI,MAAM,GAAG,MAAM,GAAG,CAAC,aAAa,CAAC,YAAY,CAC/C,GAAG,CAAC,aAAa,CAAC,eAAe,EACjC,WAAW,EACX,YAAY,CACb,CAAC;gBACF,IAAI,MAAM,CAAC,OAAO,EAAE;oBAClB,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,wBAAwB,CAAC,CAAC;oBAC5C,GAAG,CAAC,aAAa,CAAC,QAAQ,GAAG,MAAM,CAAC,IAAI,CAAC,EAAE,CAAC;oBAC5C,GAAG,CAAC,aAAa,CAAC,YAAY,GAAG,MAAM,CAAC,IAAI,CAAC,YAAY,GAAG,EAAE,CAAC;oBAC/D,GAAG,CAAC,aAAa,CAAC,iBAAiB,CAAC,GAAG,CAAC,aAAa,CAAC,CAAC;oBACvD,GAAG,CAAC,oBAAoB,GAAG,KAAK,CAAC;oBACjC,GAAG,CAAC,aAAa,CAAC,UAAU,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC;oBAC1C,GAAG,CAAC,UAAU,GAAG,EAAE,CAAC;oBACpB,GAAG,CAAC,UAAU,GAAG,EAAE,CAAC;oBACpB,GAAG,CAAC,iBAAiB,CAAC,IAAI,CAAC,8EAAsB,EAAE;wBACjD,WAAW,EAAE;4BACX,QAAQ,EAAE,GAAG,CAAC,QAAQ;4BACtB,QAAQ,EAAE,MAAM,CAAC,IAAI,CAAC,EAAE;yBACzB;qBACF,CAAC,CAAC;iBACJ;qBAAM;oBACL,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,yBAAyB,EAAE,MAAM,CAAC,CAAC;oBACrD,IAAI,MAAM,CAAC,OAAO,IAAI,MAAM,CAAC,OAAO,CAAC,OAAO,IAAI,SAAS,EAAE;wBACzD,GAAG,CAAC,wBAAwB;4BAC1B,wBAAwB;gCACxB,MAAM,CAAC,OAAO,CAAC,OAAO;gCACtB,oBAAoB,CAAC;qBACxB;yBAAM;wBACL,GAAG,CAAC,wBAAwB;4BAC1B,+EAA+E,CAAC;qBACnF;oBACD,GAAG,CAAC,YAAY,GAAG,YAAY,CAAC;oBAChC,GAAG,CAAC,WAAW,GAAG,WAAW,CAAC;oBAC9B,GAAG,CAAC,kBAAkB,EAAE,CAAC;iBAC1B;aACF;YAAC,OAAO,KAAK,EAAE;gBACd,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,yBAAyB,EAAE,KAAK,CAAC,CAAC;gBACpD,GAAG,CAAC,wBAAwB;oBAC1B,4CAA4C,CAAC;gBAC/C,GAAG,CAAC,YAAY,GAAG,YAAY,CAAC;gBAChC,GAAG,CAAC,WAAW,GAAG,WAAW,CAAC;gBAC9B,GAAG,CAAC,kBAAkB,EAAE,CAAC;aAC1B;QACH,CAAC;KAAA;IAEK,MAAM,CAAC,UAAmB,EAAE,GAAW;;;YAC3C,IAAI,UAAU,EAAE;gBACd,IAAI,CAAC,gBAAgB,CAAC,eAAe,CAAC,GAAG,GAAG,GAAG,CAAC;gBAChD,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,eAAe,EAAE,GAAG,CAAC,CAAC;gBACxC,MAAM,IAAI,CAAC,gBAAgB,CAAC,MAAM,CAAC,GAAG,EAAE,IAAI,CAAC,CAAC;gBAC9C,MAAM,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,IAAK,CAAC,CAAC;aAChC;YAED,IAAI,IAAI,CAAC,gBAAgB,CAAC,yBAAyB,EAAE;gBACnD,IAAI,MAAM,GAAG,CAAC,MAAM,IAAI,CAAC,gBAAgB;qBACtC,QAAQ,CAAC,GAAG,CAAC;qBACb,KAAK,CAAC,CAAC,GAAG,EAAE,EAAE,CAAC,IAAI,CAAC,CAAQ,CAAC;gBAChC,IAAI,MAAM,IAAI,MAAM,CAAC,KAAK,KAAK,MAAM,EAAE;oBACrC,IAAI,CAAC,MAAM,CAAC,KAAK,CACf,sBAAsB,EACtB,IAAI,CAAC,gBAAgB,CAAC,eAAe,CAAC,IAAI,CAC3C,CAAC;oBACF,IAAI,CAAC,MAAM,CAAC,KAAK,CACf,qBAAqB,EACrB,MAAM,CACP,CAAC;oBACF,MAAM,eAAe,GAAG,MAAM,IAAI,CAAC,sBAAsB,CAAC;wBACxD,IAAI,EAAE,UAAI,CAAC,gBAAgB,CAAC,eAAe,CAAC,IAAI,0CAAE,IAAI;wBACtD,IAAI,EAAE,UAAI,CAAC,gBAAgB,CAAC,eAAe,CAAC,IAAI,0CAAE,IAAI;wBACtD,KAAK,EAAE,UAAI,CAAC,gBAAgB,CAAC,eAAe,CAAC,IAAI,0CAAE,KAAK;wBACxD,MAAM,EAAE,UAAI,CAAC,gBAAgB,CAAC,eAAe,CAAC,IAAI,0CAAE,MAAM;wBAC1D,QAAQ,EAAE,MAAM,CAAC,OAAO;qBACzB,CAAC,CAAC;oBACH,IAAI,CAAC,eAAe,EAAE;wBACpB,OAAO,MAAM,IAAI,CAAC,MAAM;6BACrB,KAAK,CAAC,4DAA4D,CAAC;6BACnE,IAAI,CAAC,GAAG,EAAE;4BACT,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC;wBACrB,CAAC,CAAC,CAAC;qBACN;iBACF;aACF;YACD,OAAO,MAAM,IAAI,CAAC,cAAc,CAAC,GAAG,CAAC,CAAC;;KACvC;IAEa,SAAS;;YACrB,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,YAAY,CAAC,CAAC;YAChC,OAAO,CAAC,GAAG,CAAC,YAAY,CAAC,CAAC;YAC1B,IAAI,GAAG,GAAG,IAAI,CAAC;YACf,GAAG,CAAC,YAAY,GAAG,KAAK,CAAC;YACzB,kEAAG,mCAAgB,IAAI,OAAC;YACxB,IAAI,GAAG,CAAC,oBAAoB,KAAK,IAAI,EAAE;gBACrC,GAAG,CAAC,oBAAoB,GAAG,KAAK,CAAC;gBACjC,MAAM,GAAG,CAAC,MAAM,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC;gBAC7B,GAAG,CAAC,YAAY,CAAC,IAAI,CAAC,gBAAgB,CAAC,eAAe,EAAE,CAAC,CAAC,CAAC;gBAC3D,OAAO;aACR;YACD,GAAG,CAAC,SAAS,GAAG,KAAK,CAAC;YACtB,IAAI,CAAC,OAAO,GAAG,CAAC,CAAC;YACjB,IAAI;gBACF,IAAI,GAAG,CAAC;gBACR,MAAM,IAAI,CAAC,QAAQ,CAAC,SAAS,EAAE,CAAC,KAAK,CAAC,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC;gBACpE,MAAM,OAAO,GAAG,IAAI,IAAI,EAAE,CAAC,OAAO,EAAE,CAAC;gBACrC,IAAI,CAAC,gBAAgB,CAAC,qBAAqB,CAAC,IAAI,CAAC,CAAC;gBAClD,GAAG,GAAG,MAAM,IAAI,CAAC,gBAAgB,CAAC,qBAAqB,EAAE,CAAC;gBAC1D,IAAI,CAAC,GAAG,EAAE;oBACR,MAAM,IAAI,KAAK,CAAC,uBAAuB,CAAC,CAAC;iBAC1C;gBACD,IAAI,GAAG,GAAG,IAAI,CAAC,gBAAgB,CAAC,eAAe,CAAC,GAAG,CAAC;gBACpD,IAAI,GAAG,KAAK,SAAS,IAAI,GAAG,KAAK,IAAI,IAAI,GAAG,KAAK,EAAE,EAAE;oBACnD,IAAI,CAAC,SAAS,CACZ,iBAAiB,EACjB,qCAAqC,CACtC,CAAC;oBACF,MAAM,IAAI,CAAC,OAAO,EAAE,CAAC;iBACtB;qBAAM;oBACL,MAAM,IAAI,CAAC,SAAS,CAAC,GAAG,EAAE,KAAK,CAAC,CAAC;iBAClC;aACF;YAAC,OAAO,CAAC,EAAE;gBACV,IAAI,CAAC,MAAM,CAAC,KAAK,CACf,aAAa,EACb,CAAC,EACD,qBAAqB,EACrB,IAAI,CAAC,mBAAmB,CACzB,CAAC;gBACF,IAAI,IAAI,CAAC,mBAAmB,EAAE;oBAC5B,OAAO,IAAI,CAAC,UAAU,EAAE,CAAC;iBAC1B;gBACD,IAAI,CAAC,SAAS,GAAG,IAAI,CAAC,CAAC,iCAAiC;gBACxD,IAAI,IAAI,CAAC,SAAS,EAAE;oBAClB,IAAI,CAAC,OAAO,GAAG,CAAC,CAAC;oBACjB,OAAO,IAAI,CAAC,iBAAiB,EAAE,CAAC;iBACjC;qBAAM;oBACL,IAAI,CAAC,SAAS,GAAG,IAAI,CAAC;oBACtB,MAAM,IAAI,CAAC,gBAAgB,CAAC,UAAU,CAAC,IAAI,EAAE,IAAI,CAAC,QAAQ,CAAC,CAAC;oBAC5D,OAAO,IAAI,CAAC,SAAS,EAAE,CAAC;iBACzB;aACF;QACH,CAAC;KAAA;IAEa,gBAAgB,CAAC,YAA0B;;YACvD,MAAM,KAAK,GAAG,MAAM,IAAI,CAAC,eAAe,CAAC,MAAM,CAAC,YAAY,CAAC,CAAC;YAC9D,MAAM,IAAI,CAAC,MAAM,CAAC,WAAW,EAAE,CAAC;YAChC,KAAK,CAAC,OAAO,EAAE,CAAC,IAAI,CAAC,GAAG,EAAE;gBACxB,6BAA6B;YAC/B,CAAC,CAAC,CAAC;YACH,oCAAoC;YACpC,8BAA8B;YAC9B,MAAM;YACN,OAAO,KAAK,CAAC,YAAY,EAAE,CAAC;QAC9B,CAAC;KAAA;IAEa,sBAAsB,CAAC,IAMpC;;YACC,MAAM,EAAE,IAAI,EAAE,GAAG,MAAM,IAAI,CAAC,gBAAgB,CAAC;gBAC3C,SAAS,EAAE,mGAAoB;gBAC/B,cAAc,EAAE;oBACd,IAAI,EAAE,IAAI;iBACX;gBACD,YAAY,EAAE,IAAI;gBAClB,eAAe,EAAE,KAAK;aACvB,CAAC,CAAC;YACH,OAAO,IAAI,IAAI,IAAI,CAAC,OAAO,CAAC;QAC9B,CAAC;KAAA;IAEa,cAAc,CAAC,GAAG;;YAC9B,IAAI,IAAI,CAAC,YAAY,EAAE;gBACrB,OAAO;aACR;YACD,IAAI,CAAC,iBAAiB,GAAG,IAAI,CAAC;YAC9B,IAAI,CAAC,mBAAmB,GAAG,KAAK,CAAC;YACjC,IAAI,CAAC,YAAY,GAAG,KAAK,CAAC;YAC1B,MAAM,OAAO,GAAG,IAAI,IAAI,EAAE,CAAC,OAAO,EAAE,CAAC;YACrC,IAAI,CAAC,gBAAgB,CAAC,qBAAqB,CAAC,IAAI,CAAC,CAAC;YAClD,IAAI,GAAG,GAAG,MAAM,IAAI,CAAC,gBAAgB,CAAC,WAAW,CAAC,GAAG,CAAC,CAAC;YACvD,IAAI,CAAC,iBAAiB,GAAG,KAAK,CAAC;YAC/B,MAAM,OAAO,GAAG,IAAI,CAAC,gBAAgB,CAAC,cAAc,CAAC;YACrD,MAAM,KAAK,GAAG,IAAI,IAAI,EAAE,CAAC,OAAO,EAAE,CAAC;YACnC,IAAI,CAAC,MAAM,CAAC,KAAK,CACf,sBACE,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC,KAAK,GAAG,OAAO,CAAC,GAAG,IAAI,CAAC,GAAG,GAAG,CAAC,GAAG,GACjD,yBACE,IAAI,CAAC,KAAK,CAAC,CAAC,OAAO,GAAG,IAAI,CAAC,GAAG,GAAG,CAAC,GAAG,GACvC,UAAU,CACX,CAAC;YACF,IAAI,CAAC,QAAQ,CAAC,eAAe,EAAE,CAAC,KAAK,CAAC,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC;YAEpE,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,QAAQ,EAAE,GAAG,CAAC,CAAC;YACjC,MAAM,IAAI,CAAC,UAAU,EAAE,CAAC;QAC1B,CAAC;KAAA;IAEa,iBAAiB,CAAC,GAAG,GAAG,EAAE,EAAE,KAAK,GAAG,EAAE;;YAClD,IAAI,IAAI,CAAC,mBAAmB;gBAAE,OAAO;YACrC,IAAI,CAAC,mBAAmB,GAAG,IAAI,CAAC;YAChC,MAAM,IAAI,CAAC,MAAM,CAAC,KAAK,CACrB,GAAG;gBACD,gFAAgF,EAClF,KAAK,IAAI,aAAa,CACvB,CAAC;YAEF,IAAI,CAAC,mBAAmB,GAAG,KAAK,CAAC;QACnC,CAAC;KAAA;IAEK,gBAAgB;;YACpB,IAAI,CAAC,YAAY,GAAG,IAAI,CAAC;YACzB,IAAI,CAAC,UAAU,GAAG,EAAE,CAAC;YACrB,IAAI,CAAC,UAAU,GAAG,sBAAsB,CAAC;YACzC,IAAI,CAAC,mBAAmB,GAAG,IAAI,CAAC;YAChC,OAAO,IAAI,CAAC,MAAM,CAAC,SAAS,CAAC,sEAAc,CAAC,CAAC,IAAI,CAAC,GAAS,EAAE,CAAC;gBAC5D,IAAI,mFAAoB,EAAE;oBACxB,OAAO,CAAC,GAAG,CAAC,wBAAwB,CAAC,CAAC;oBACtC,IAAI,CAAC,GAAG,CAAC,QAAQ,EAAE,CAAC;iBACrB;gBACD,MAAM,IAAI,CAAC,gBAAgB,CAAC,UAAU,CAAC,IAAI,EAAE,IAAI,CAAC,QAAQ,CAAC,CAAC;YAC9D,CAAC,EAAC,CAAC;QACL,CAAC;KAAA;IAED,IAAI,WAAW;QACb,IAAI,kFAAmB,EAAE;YACvB,OAAO,IAAI,CAAC,gBAAgB,CAAC,WAAW,CAAC;SAC1C;QACD,OAAO,IAAI,CAAC;IACd,CAAC;IAEK,OAAO;;YACX,IAAI,GAAG,GAAG,IAAI,CAAC;YACf,IAAI,GAAG,CAAC,YAAY,EAAE;gBACpB,OAAO;aACR;YACD,IAAI,kFAAmB,EAAE;gBACvB,GAAG,CAAC,cAAc,CAAC,IAAI,CAAC,EAAE,WAAW,EAAE,UAAU,EAAE,MAAM,EAAE,EAAE,EAAE,CAAC,CAAC,IAAI,CACnE,CAAO,WAAW,EAAE,EAAE,CAAC;oBACrB,IAAI,WAAW,CAAC,SAAS,EAAE;wBACzB,IAAI,WAAW,CAAC,IAAI,IAAI,WAAW,CAAC,IAAI,KAAK,UAAU,EAAE;4BACvD,MAAM,IAAI,CAAC,cAAc,EAAE,CAAC;yBAC7B;6BAAM;4BACL,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC;yBACpB;qBACF;yBAAM,IAAI,WAAW,EAAE;wBACtB,IAAI,GAAG,GAAG,WAAW,CAAC,IAAI,CAAC;wBAC3B,IACE,WAAW,CAAC,MAAM,KAAK,SAAS;4BAChC,CAAC,GAAG,IAAI,EAAE,IAAI,GAAG,CAAC,MAAM,IAAI,EAAE,CAAC,EAC/B;4BACA,IAAI,GAAG,CAAC,MAAM,GAAG,EAAE,EAAE;gCACnB,GAAG,GAAG,GAAG,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC;6BACxB;4BACD,MAAM,IAAI,CAAC,SAAS,CAAC,GAAG,EAAE,IAAI,CAAC,CAAC;yBACjC;6BAAM;4BACL,MAAM,GAAG,CAAC,MAAM,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC;4BAC7B,MAAM,GAAG,CAAC,OAAO,EAAE,CAAC;yBACrB;qBACF;gBACH,CAAC,GACD,CAAO,GAAG,EAAE,EAAE,CAAC;oBACb,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;oBACvB,MAAM,GAAG,CAAC,MAAM,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC;oBAC7B,MAAM,GAAG,CAAC,OAAO,EAAE,CAAC;gBACtB,CAAC,EACF,CAAC;aACH;iBAAM;gBACL,MAAM,IAAI,CAAC,cAAc,EAAE,CAAC;aAC7B;QACH,CAAC;KAAA;IAEK,SAAS,CAAC,GAAW,EAAE,UAAU,GAAG,IAAI;;YAC5C,IAAI,CAAC,SAAS,CAAC,EAAE,EAAE,gBAAgB,GAAG,GAAG,CAAC,CAAC;YAC3C,mEAAI,mCAAgB,IAAI,OAAC;YACzB,IAAI,MAAM,GAAG,MAAM,IAAI,CAAC,cAAc,CAAC,SAAS,CAAC,GAAG,CAAC,CAAC;YACtD,IAAI,MAAM,CAAC,OAAO,IAAI,MAAM,CAAC,IAAI,EAAE;gBACjC,IAAI,UAAU,EAAE;oBACd,IAAI,CAAC,SAAS,CAAC,EAAE,EAAE,eAAe,GAAG,GAAG,CAAC,CAAC;iBAC3C;gBACD,mEAAI,mCAAgB,MAAM,CAAC,IAAI,OAAC;gBAChC,OAAO,MAAM,IAAI,CAAC,MAAM,CAAC,UAAU,EAAE,GAAG,CAAC,CAAC;aAC3C;iBAAM;gBACL,IAAI,MAAM,CAAC,OAAO,IAAI,MAAM,CAAC,OAAO,CAAC,IAAI,IAAI,CAAC,CAAC,EAAE;oBAC/C,IAAI,CAAC,MAAM,CAAC,KAAK,CACf,MAAM,CAAC,OAAO,CAAC,IAAI,KAAK,IAAI;wBAC1B,CAAC,CAAC,OAAO,GAAG,cAAc;wBAC1B,CAAC,CAAC,MAAM,CAAC,OAAO,CAAC,OAAO,EAC1B,OAAO,EACP;wBACE;4BACE,IAAI,EAAE,IAAI;4BACV,OAAO,EAAE,GAAG,EAAE;gCACZ,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC;4BACrB,CAAC;yBACF;qBACF,CACF,CAAC;iBACH;qBAAM;oBACL,MAAM,OAAO,GACX,wBAAwB;wBACxB,GAAG;wBACH,wDAAwD,CAAC;oBAC3D,IAAI,CAAC,MAAM,CAAC,OAAO,CACjB,OAAO,EACP,OAAO,EACP,GAAG,EAAE;wBACH,IAAI,CAAC,SAAS,CAAC,GAAG,EAAE,UAAU,CAAC,CAAC;oBAClC,CAAC,EACD,GAAG,EAAE;wBACH,IAAI,CAAC,MAAM,EAAE,CAAC;oBAChB,CAAC,EACD,OAAO,EACP,QAAQ,CACT,CAAC;iBACH;aACF;QACH,CAAC;KAAA;IAEa,cAAc;;YAC1B,wCAAwC;YACxC,MAAM,KAAK,GAAG,MAAM,IAAI,CAAC,eAAe,CAAC,MAAM,CAAC;gBAC9C,SAAS,EAAE,mEAAY;gBACvB,cAAc,EAAE;oBACd,OAAO,EAAE,IAAI;iBACd;aACF,CAAC,CAAC;YACH,MAAM,KAAK,CAAC,OAAO,EAAE,CAAC;YACtB,MAAM,EAAE,IAAI,EAAE,GAAG,MAAM,KAAK,CAAC,YAAY,EAAE,CAAC;YAC5C,IAAI,CAAC,SAAS,CAAC,EAAE,EAAE,eAAe,GAAG,IAAI,CAAC,GAAG,CAAC,CAAC;YAC/C,mEAAI,mCAAgB,IAAI,CAAC,IAAI,OAAC;YAC9B,OAAO,MAAM,IAAI,CAAC,MAAM,CAAC,IAAI,EAAE,IAAI,CAAC,GAAG,CAAC,CAAC;QAC3C,CAAC;KAAA;IAEa,UAAU;;YACtB,IAAI,IAAI,CAAC,YAAY,EAAE;gBACrB,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,cAAc,EAAE,IAAI,CAAC,YAAY,CAAC,CAAC;gBACrD,OAAO;aACR;YACD,IAAI,WAAW,GAAG,IAAI,CAAC,gBAAgB,CAAC,eAAe,CAAC;YACxD,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,iBAAiB,EAAE,WAAW,CAAC,CAAC;YAClD,IAAI,SAAS,GAAG,YAAY,CAAC,OAAO,CAAC,sFAAiC,CAAC,CAAC;YACxE,IAAI,aAAa,GAAG,CAAC,CAAC;YACtB,IACE,KAAK,CAAC,WAAW,CAAC,OAAO,CAAC;gBAC1B,WAAW,CAAC,OAAO,IAAI,CAAC;gBACxB,WAAW,CAAC,OAAO,GAAG,yEAAiB,EACvC;gBACA,IAAI,SAAS,IAAI,SAAS,KAAK,WAAW,CAAC,GAAG,EAAE;oBAC9C,aAAa,GAAG,IAAI,CAAC,aAAa,CAAC,OAAO,CAAC;iBAC5C;gBACD,IAAI,aAAa,IAAI,aAAa,GAAG,CAAC,EAAE;oBACtC,WAAW,CAAC,OAAO,GAAG,aAAa,CAAC;oBACpC,IAAI,CAAC,MAAM,CAAC,KAAK,CACf,yCAAyC,EACzC,aAAa,CACd,CAAC;iBACH;aACF;YACD,IAAI,IAAI,CAAC,gBAAgB,EAAE;gBACzB,IAAI,CAAC,gBAAgB,CAAC,GAAG,GAAG,WAAW,CAAC,GAAG,CAAC;gBAC5C,IAAI,WAAW,CAAC,IAAI,EAAE;oBACpB,IAAI,CAAC,gBAAgB,CAAC,IAAI,GAAG,WAAW,CAAC,IAAI,CAAC,IAAI,CAAC;oBACnD,IAAI,CAAC,gBAAgB,CAAC,IAAI,GAAG,WAAW,CAAC,IAAI,CAAC,IAAI,CAAC;oBACnD,IAAI,CAAC,gBAAgB,CAAC,KAAK,GAAG,WAAW,CAAC,IAAI,CAAC,KAAK,CAAC;iBACtD;gBACD,IAAI,CAAC,gBAAgB,CAAC,OAAO,GAAG,WAAW,CAAC,OAAO,CAAC;gBACpD,gEAAW,CAAC,wFAAmC,EAAE,IAAI,CAAC,gBAAgB,CAAC,CAAC;aACzE;YACD,IAAI,CAAC,OAAO,GAAG,GAAG,CAAC;YACnB,MAAM,IAAI,CAAC,mBAAmB,CAAC,WAAW,EAAE,gFAAqB,CAAC,CAAC;QACrE,CAAC;KAAA;IAED,eAAe;QACb,IAAI,CAAC,YAAY,CAAC,WAAW,CAAC,yFAAwB,CAAC,CAAC;QACxD,IAAI,CAAC,YAAY,CAAC,WAAW,CAAC,4FAA2B,CAAC,CAAC;QAC3D,IAAI,CAAC,YAAY,CAAC,WAAW,CAAC,+FAA8B,CAAC,CAAC;QAC9D,IAAI,CAAC,YAAY,CAAC,WAAW,CAAC,2FAA0B,CAAC,CAAC;QAC1D,IAAI,CAAC,YAAY,CAAC,WAAW,CAAC,iGAAgC,CAAC,CAAC;QAChE,IAAI,CAAC,YAAY,CAAC,WAAW,CAAC,6FAA4B,CAAC,CAAC;QAC5D,IAAI,IAAI,CAAC,uBAAuB,EAAE;YAChC,aAAa,CAAC,IAAI,CAAC,uBAAuB,CAAC,CAAC;YAC5C,IAAI,CAAC,uBAAuB,GAAG,IAAI,CAAC;SACrC;QACD,IAAI,IAAI,CAAC,eAAe,EAAE;YACxB,YAAY,CAAC,IAAI,CAAC,eAAe,CAAC,CAAC;YACnC,IAAI,CAAC,eAAe,GAAG,IAAI,CAAC;SAC7B;QAED,IAAI,CAAC,mBAAmB,GAAG,IAAI,CAAC;QAChC,yDAAyD;QACzD,QAAQ,CAAC,mBAAmB,CAAC,YAAY,EAAE,GAAG,EAAE;YAC9C,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,8BAA8B,CAAC,CAAC;QACpD,CAAC,CAAC,CAAC;IACL,CAAC;IAEM,iCAAiC;QACtC,IAAI,CAAC,QAAQ,CAAC,KAAK,EAAE,CAAC,IAAI,CAAC,GAAG,EAAE;YAC9B,QAAQ,CAAC,gBAAgB,CAAC,YAAY,EAAE,GAAG,EAAE;gBAC3C,IAAI,CAAC,sBAAsB,EAAE,CAAC;YAChC,CAAC,CAAC,CAAC;QACL,CAAC,CAAC,CAAC;IACL,CAAC;IAEO,sBAAsB;QAC5B,IAAI,CAAC,MAAM,EAAE,CAAC;IAChB,CAAC;IAEK,MAAM,CAAC,OAAO,GAAG,IAAI,EAAE,YAAY,GAAG,KAAK;;YAC/C,IAAI,kFAAmB,EAAE;gBACvB,IAAI,CAAC,YAAY,GAAG,IAAI,CAAC;gBACzB,IAAI,OAAO,EAAE;oBACX,IAAI,CAAC,MAAM,CAAC,OAAO,CACjB,eAAe,EACf,0EAAkB,EAClB,GAAS,EAAE,CAAC;wBACV,IAAI,CAAC,gBAAgB,EAAE,CAAC;oBAC1B,CAAC,GACD,GAAG,EAAE;wBACH,IAAI,YAAY,EAAE;4BAChB,IAAI,CAAC,kBAAkB,EAAE,CAAC;yBAC3B;6BAAM;4BACL,IAAI,CAAC,YAAY,GAAG,KAAK,CAAC;yBAC3B;oBACH,CAAC,CACF,CAAC;iBACH;qBAAM;oBACL,IAAI,CAAC,gBAAgB,EAAE,CAAC;iBACzB;aACF;QACH,CAAC;KAAA;;;;QA5dC,IAAI,CAAC,YAAY,CAAC,OAAO,CAAC,iGAAgC,CAAC,CAAC;QAC5D,OAAO,MAAM,IAAI,CAAC,gBAAgB,CAAC,YAAY,EAAE,CAAC;IACpD,CAAC;;oFApQU,kBAAkB;iHAAlB,kBAAkB;QCjD/B,kFAAiC;QAC/B,0EAAsC;QACpC,gHAgBM;QAEN,gHAaM;QACN,+GAUM;QACR,6DAAM;QACR,6DAAc;;QA5CsC,2DAAyB;QAAzB,0FAAyB;QAkBxB,2DAAyB;QAAzB,0FAAyB;QAcV,2DAAwB;QAAxB,yFAAwB","sources":["./src/app/pages/vehicle-linking/vehicle-linking.page.ts","./src/app/pages/vehicle-linking/vehicle-linking.page.html"],"sourcesContent":["import { ChangeDetectorRef, Component, NgZone } from '@angular/core';\nimport { ModalController, ModalOptions, Platform } from '@ionic/angular';\nimport {\n  AppConfig,\n  AppStrings,\n  MAX_MILEAGE_VALUE,\n} from 'src/app/configs/app.config';\nimport {\n  BleData,\n  InfoToolConnected,\n  VehicleModel,\n} from 'src/app/models/app.model';\nimport { InnovaVCIService } from 'src/app/services/innova-vci.service';\nimport { NavigationService } from 'src/app/services/navigation.service';\nimport { RoutePath } from 'src/app/app-routing.module';\nimport {\n  EnumAppEvent,\n  EnumAppDataKey,\n  EnumLocalStorage,\n} from 'src/app/models/app.enum';\nimport {\n  InnovaVCIEvent,\n  VCIResponseData,\n} from 'src/app/services/innova-tool-models';\nimport { ApiDecodeVinResponse } from 'src/app/services/api.models';\nimport { AppData } from 'src/app/models/app.data';\nimport _ from 'lodash';\nimport { Insomnia } from '@ionic-native/insomnia/ngx';\nimport { EnterVinPage } from '../enter-vin/enter-vin.page';\nimport { ReportSession, ReportStatus } from 'src/app/models/report-session';\nimport { ReportServiceProvider } from 'src/app/services/report-service/report-service';\nimport { BarcodeScanner } from '@ionic-native/barcode-scanner/ngx';\nimport { VehicleServiceProvider } from 'src/app/services/vehicle-service/vehicle-service';\nimport { BLE } from '@ionic-native/ble/ngx';\nimport { Events } from 'src/app/services/events.service';\nimport { HelperService } from 'src/app/services/helper.service';\nimport { BaseController } from 'src/app/bases/base-controller';\nimport { StorageKeys } from 'src/app/models/app.constant';\nimport { AppState } from 'src/app/services/state/app.state';\nimport { ConnectivityService } from 'src/app/services/innova-vci-service/src/connectivity/connectivity.service';\nimport { VehicleSelectionPage } from '../../modals/vehicle-selection/vehicle-selection.page';\nimport { Diagnostic } from '@ionic-native/diagnostic/ngx';\nimport { OpenNativeSettings } from '@ionic-native/open-native-settings/ngx';\n\n@Component({\n  selector: 'app-vehicle-linking',\n  templateUrl: './vehicle-linking.page.html',\n  styleUrls: ['./vehicle-linking.page.scss'],\n})\nexport class VehicleLinkingPage extends BaseController {\n  title = 'Scanning devices';\n  isRescan = false;\n  statusText: string;\n  resultText: string;\n  isScanning = true;\n  hasMultipleDevices = false;\n  retry = 0;\n  timer: any;\n  retryingCreateReport = false;\n  percent = 0;\n  isScanningVIN = false;\n  isScanningModules = false;\n  found = false;\n  result = 'Starting scan';\n  private isRetried = false;\n  isCancelling = false;\n  creatingReport = false;\n  deviceId = '';\n  toolName = '';\n  reportSession: ReportSession;\n  devices: BleData[];\n  createReportErrorMessage = '';\n  vciRepsonse: VCIResponseData;\n  reportStatus: ReportStatus;\n  private isLeaveScanningPage = false;\n  public toolInfo: InfoToolConnected;\n  private connectedVehicle: ApiDecodeVinResponse;\n  private scanningTimeout = null;\n  #vehicleData: VehicleModel;\n  multipleDevicesInterval = null;\n  constructor(\n    private modalController: ModalController,\n    private innovaVciService: InnovaVCIService,\n    private helper: HelperService,\n    private navigationService: NavigationService,\n    private connService: ConnectivityService,\n    private platform: Platform,\n    private insomnia: Insomnia,\n    private zone: NgZone,\n    private diagnostic: Diagnostic,\n    private openNativeSettings: OpenNativeSettings,\n    private reportService: ReportServiceProvider,\n    private eventService: Events,\n    private barcodeScanner: BarcodeScanner,\n    private changeDetector: ChangeDetectorRef,\n    private vehicleService: VehicleServiceProvider,\n    private ble: BLE\n  ) {\n    super('VehicleLinkingPage');\n  }\n\n  setStatus(result, status = '') {\n    console.log('🚀 ~ VehicleLinkingPage ~ setStatus ~ result:', result)\n    this.zone.run(() => {\n      if (result != null) {\n        this.resultText = result;\n        this.logger.debug(this.resultText + ' - ' + status);\n      }\n      this.statusText = status;\n    });\n  }\n\n  selectDevice(device: BleData) {\n    console.log('🚀 ~ VehicleLinkingPage ~ selectDevice ~ device:', device)\n    this.eventService.publish(InnovaVCIEvent.DEVICE_SELECTED, device);\n    this.isScanning = false;\n    this.hasMultipleDevices = false;\n    // this.title = 'Loading...';\n    this.helper.refreshLayout(this.changeDetector);\n  }\n\n  async ionViewWillEnter() {\n    this.hasMultipleDevices = false;\n    this.isScanning = false;\n    this.isCancelling = false;\n    this.creatingReport = false;\n    this.isLeaveScanningPage = false;\n    this.createReportErrorMessage = '';\n    this.vciRepsonse = null;\n    this.reportStatus = ReportStatus.Incomplete;\n    this.reportSession = this.reportService.getReportSession();\n    this.connectedVehicle = AppData.get(EnumAppDataKey.InfoVehicleConnected);\n    this.isRescan = this.helper.coerceBooleanProperty(\n      this.navigationService.getQueryParam('isRescan')\n    );\n    if (this.isRescan) {\n      this.title = 'Rescanning modules';\n      this.result = '';\n    } else {\n      this.isScanning = true;\n      this.title = 'Scanning devices';\n      this.result = 'Starting scan';\n      this.eventService.subscribe(\n        InnovaVCIEvent.CONNECTED,\n        (device: BleData) => {\n          this.logger.debug('Connected: ', device);\n          this.deviceId = device.id;\n          this.toolName = device.name;\n          this.title = 'Loading';\n          this.setStatus(\n            device.name + ' has been connected',\n            'Linking to vehicle...'\n          );\n          this.isScanning = false;\n          if (this.scanningTimeout) {\n            clearTimeout(this.scanningTimeout);\n            this.scanningTimeout = null;\n          }\n          if (this.multipleDevicesInterval) {\n            clearInterval(this.multipleDevicesInterval);\n            this.multipleDevicesInterval = null;\n          }\n          this.startScan();\n        }\n      );\n      let ctx = this;\n      ctx.devices = [];\n      this.eventService.subscribe(\n        InnovaVCIEvent.DEVICE_FOUND,\n        (device: BleData) => {\n          if (!ctx.devices) {\n            ctx.devices = [];\n          }\n          if (ctx.devices.findIndex((d) => d.id === device.id) < 0) {\n            ctx.devices.push(device);\n          }\n        }\n      );\n      ctx.multipleDevicesInterval = setInterval(() => {\n        if (ctx.isScanning) {\n          if (ctx.devices.length > 0) {\n            if (this.multipleDevicesInterval) {\n              clearInterval(this.multipleDevicesInterval);\n              this.multipleDevicesInterval = null;\n            }\n            ctx.eventService.unsubscribe(InnovaVCIEvent.DEVICE_FOUND);\n            ctx.isScanning = false;\n            clearTimeout(ctx.scanningTimeout);\n            ctx.scanningTimeout = null;\n            if (AppState.isOnAndroid) {\n              console.log('Call this.ble.stopScan');\n              ctx.connService.stopScan();\n            }\n            if (ctx.devices.length > 1) {\n              ctx.hasMultipleDevices = true;\n            } else {\n              ctx.selectDevice(ctx.devices[0]);\n            }\n            ctx.helper.refreshLayout(ctx.changeDetector);\n          }\n        } else {\n          clearInterval(ctx.multipleDevicesInterval);\n          ctx.multipleDevicesInterval = null;\n        }\n      }, AppConfig.scanningDevicesInterval);\n\n      this.isScanningModules = false;\n      this.eventService.subscribe(\n        EnumAppEvent.InfoToolConnected,\n        async (toolInfo) => {\n          this.eventService.unsubscribe(EnumAppEvent.InfoToolConnected);\n          this.logger.debug(toolInfo);\n          this.toolInfo = toolInfo;\n          if (this.toolInfo) {\n            localStorage.setItem(\n              StorageKeys.FIRMWARE_VERSION,\n              this.toolInfo.main\n            );\n          }\n        }\n      );\n\n      this.scanningTimeout = setTimeout(async () => {\n        if (!this.isConnected) {\n          this.navigationService\n            .goTo(RoutePath.ConnectionFailed)\n            .then(async () => {\n              if (AppState.isOnAndroid) {\n                console.log('Call this.ble.stopScan');\n                this.ble.stopScan();\n              }\n              await this.innovaVciService.disconnect(true, this.deviceId);\n            })\n        }\n      }, AppConfig.scanningDevicesTimeout);\n    }\n    console.log('🚀 ~ VehicleLinkingPage ~ ionViewWillEnter ~ DONE ionViewWillEnter:');\n  }\n\n  async ionViewDidEnter() {\n    this.eventService.subscribe(InnovaVCIEvent.SCAN_STATUS, (res) => {\n      let name = _.get(res, 'name');\n      let result = _.get(res, 'result');\n      this.setStatus(result, name);\n    });\n    // Check Bluetooth Permission\n    //bao check temp\n    let isBtEnabled = await this.helper.checkBluetoothPermissions();\n    if (!isBtEnabled) {\n      if (AppState.isOnAndroid && !AppState.isOnAtLeastVersion(13)) {\n        this.helper.confirm(\n          'In order to detect and pair to your scan tool, please turn Bluetooth ON.',\n          'Bluetooth is turned OFF',\n          async () => {\n            isBtEnabled = await this.diagnostic.setBluetoothState(true);\n            this.logger.debug('Is BT Enabled', isBtEnabled);\n            if (isBtEnabled) {\n              this.startScanNow();\n            } else {\n              this.helper.goBack();\n            }\n          },\n          () => {\n            this.helper.goBack();\n          },\n          'Turn Bluetooth ON',\n          'Cancel'\n        );\n      } else {\n        this.helper.confirm(\n          'In order to detect and pair to your scan tool, turn Bluetooth ON from your device’s settings.',\n          'Bluetooth is turned OFF',\n          async () => {\n            if (AppState.isOnAndroid) {\n              this.diagnostic.switchToBluetoothSettings();\n            } else {\n              this.openNativeSettings.open('settings').catch((ex) => {\n                this.logger?.info('openSettings>openNativeSettings>Error', ex);\n              });\n            }\n          },\n          () => {\n            this.helper.goBack();\n          },\n          'Go to settings',\n          'Cancel'\n        );\n      }\n    } else {\n      this.startScanNow();\n    }\n  }\n\n  async startScanNow() {\n    console.log('this.isRescan: ', this.isRescan);\n    if (this.isRescan) {\n      this.isScanningModules = true;\n      this.setStatus('', 'Read supported modules...');\n      return await this.scanOEMModules(\n        this.innovaVciService.vciResponseData.vin\n      );\n    } else {\n      return await this.#startScanTools();\n    }\n  }\n\n  async #startScanTools() {\n    this.eventService.publish(InnovaVCIEvent.INTERRUPT_PROCESS);\n    return await this.innovaVciService.initializeBT();\n  }\n\n  async saveAndCreateReport(\n    vciRepsonse: VCIResponseData,\n    reportStatus: ReportStatus\n  ) {\n    this.setStatus('', 'Creating report...');\n    let ctx = this;\n    if (ctx.isCancelling) {\n      return;\n    }\n    ctx.reportService.saveReportSession(ctx.reportSession);\n\n    ctx.creatingReport = true;\n    await ctx.helper.sleep(1000);\n    await ctx.createReport(vciRepsonse, reportStatus);\n  }\n\n  createReportFailed() {\n    this.retryingCreateReport = true;\n    this.creatingReport = false;\n    this.isCancelling = true;\n    this.helper.confirm(\n      this.createReportErrorMessage,\n      '',\n      async () => {\n        this.isCancelling = false;\n        await this.createReport(this.vciRepsonse, this.reportStatus);\n      },\n      () => {\n        this.cancel(true, true);\n      },\n      'Try Again',\n      'Cancel'\n    );\n  }\n\n  async createReport(vciRepsonse: VCIResponseData, reportStatus: ReportStatus) {\n    let ctx = this;\n    try {\n      ctx.creatingReport = true;\n      ctx.isScanningModules = false;\n      this.logger.debug('Creating report');\n      if (!vciRepsonse.mileage) {\n        vciRepsonse.mileage = ctx.reportSession.mileage;\n      }\n      let result = await ctx.reportService.createReport(\n        ctx.reportSession.workOrderNumber,\n        vciRepsonse,\n        reportStatus\n      );\n      if (result.success) {\n        this.logger.debug('Report Created Success');\n        ctx.reportSession.reportId = result.data.id;\n        ctx.reportSession.reportNumber = result.data.reportNumber + '';\n        ctx.reportService.saveReportSession(ctx.reportSession);\n        ctx.retryingCreateReport = false;\n        ctx.reportService.saveReport(result.data);\n        ctx.resultText = '';\n        ctx.statusText = '';\n        ctx.navigationService.goTo(RoutePath.ScanComplete, {\n          queryParams: {\n            deviceId: ctx.deviceId,\n            reportId: result.data.id\n          },\n        });\n      } else {\n        this.logger.debug('Unable to create report', result);\n        if (result.message && result.message.message != undefined) {\n          ctx.createReportErrorMessage =\n            'Create report failed: ' +\n            result.message.message +\n            ' Please try again.';\n        } else {\n          ctx.createReportErrorMessage =\n            'Unable to create report. Please check your internet connection and try again.';\n        }\n        ctx.reportStatus = reportStatus;\n        ctx.vciRepsonse = vciRepsonse;\n        ctx.createReportFailed();\n      }\n    } catch (error) {\n      this.logger.debug('Unable to create report', error);\n      ctx.createReportErrorMessage =\n        'Unable to create report. Please try again.';\n      ctx.reportStatus = reportStatus;\n      ctx.vciRepsonse = vciRepsonse;\n      ctx.createReportFailed();\n    }\n  }\n\n  async gotVIN(needSetVIN: boolean, vin: string) {\n    if (needSetVIN) {\n      this.innovaVciService.vciResponseData.vin = vin;\n      this.logger.debug('Writing VIN: ', vin);\n      await this.innovaVciService.setVin(vin, true);\n      await this.helper.sleep(2_000);\n    }\n\n    if (this.innovaVciService.needUpdateMoreVehicleInfo) {\n      let result = (await this.innovaVciService\n        .ymme_get(254)\n        .catch((err) => null)) as any;\n      if (result && result.field !== 'Done') {\n        this.logger.debug(\n          'vciResponseData ymme',\n          this.innovaVciService.vciResponseData.ymme\n        );\n        this.logger.debug(\n          'ymme_get 254 result',\n          result\n        );\n        const isVehicleInfoOk = await this.setVehicleInfoFromUser({\n          year: this.innovaVciService.vciResponseData.ymme?.year,\n          make: this.innovaVciService.vciResponseData.ymme?.make,\n          model: this.innovaVciService.vciResponseData.ymme?.model,\n          engine: this.innovaVciService.vciResponseData.ymme?.engine,\n          options1: result.options,\n        });\n        if (!isVehicleInfoOk) {\n          return await this.helper\n            .alert('T7R-85 Toyota, Lexus, Scion Pop-Up: Could not auto confirm')\n            .then(() => {\n              this.cancel(false);\n            });\n        }\n      }\n    }\n    return await this.scanOEMModules(vin);\n  }\n\n  private async startScan() {\n    this.logger.debug('start scan');\n    console.log('start scan');\n    let ctx = this;\n    ctx.isCancelling = false;\n    ctx.#vehicleData = null;\n    if (ctx.retryingCreateReport === true) {\n      ctx.retryingCreateReport = false;\n      await ctx.helper.sleep(1000);\n      ctx.createReport(this.innovaVciService.vciResponseData, 0);\n      return;\n    }\n    ctx.isRetried = false;\n    this.percent = 0;\n    try {\n      let res;\n      await this.insomnia.keepAwake().catch(this.logger.debug.bind(null));\n      const startMs = new Date().getTime();\n      this.innovaVciService.enableReportSleepTime(true);\n      res = await this.innovaVciService.connectAndRequestData();\n      if (!res) {\n        throw new Error('Could not query data.');\n      }\n      let vin = this.innovaVciService.vciResponseData.vin;\n      if (vin === undefined || vin === null || vin === '') {\n        this.setStatus(\n          'No VIN Detected',\n          'Starting scan VIN or Enter Manually'\n        );\n        await this.scanVin();\n      } else {\n        await this.decodeVIN(vin, false);\n      }\n    } catch (e) {\n      this.logger.debug(\n        'Scan failed',\n        e,\n        'isLeaveScanningPage',\n        this.isLeaveScanningPage\n      );\n      if (this.isLeaveScanningPage) {\n        return this.onScanDone();\n      }\n      this.isRetried = true; // Disable Retry when scan failed\n      if (this.isRetried) {\n        this.percent = 0;\n        return this.showFailureDialog();\n      } else {\n        this.isRetried = true;\n        await this.innovaVciService.disconnect(true, this.deviceId);\n        return this.startScan();\n      }\n    }\n  }\n\n  private async getDataFromModal(modalOptions: ModalOptions) {\n    const modal = await this.modalController.create(modalOptions);\n    await this.helper.hideLoading();\n    modal.present().then(() => {\n      // this.currentModal = modal;\n    });\n    // modal.onDidDismiss().then(() => {\n    //   this.currentModal = null;\n    // });\n    return modal.onDidDismiss();\n  }\n\n  private async setVehicleInfoFromUser(ymme: {\n    year: string;\n    make: string;\n    model: string;\n    engine: string;\n    options1: string[];\n  }) {\n    const { data } = await this.getDataFromModal({\n      component: VehicleSelectionPage,\n      componentProps: {\n        ymme: ymme,\n      },\n      showBackdrop: true,\n      backdropDismiss: false,\n    });\n    return data && data.confirm;\n  }\n\n  private async scanOEMModules(vin) {\n    if (this.isCancelling) {\n      return;\n    }\n    this.isScanningModules = true;\n    this.isLeaveScanningPage = false;\n    this.isCancelling = false;\n    const startMs = new Date().getTime();\n    this.innovaVciService.enableReportSleepTime(true);\n    let res = await this.innovaVciService.scanModules(vin);\n    this.isScanningModules = false;\n    const sleepMs = this.innovaVciService.totalSleepTime;\n    const endMs = new Date().getTime();\n    this.logger.debug(\n      `[*Done] Scan time: ${\n        Math.round(((endMs - startMs) / 1000) * 100) / 100\n      } seconds. Sleep time: ${\n        Math.round((sleepMs / 1000) * 100) / 100\n      } seconds`\n    );\n    this.insomnia.allowSleepAgain().catch(this.logger.debug.bind(null));\n\n    this.logger.debug('result', res);\n    await this.onScanDone();\n  }\n\n  private async showFailureDialog(msg = '', title = '') {\n    if (this.isLeaveScanningPage) return;\n    this.isLeaveScanningPage = true;\n    await this.helper.alert(\n      msg ||\n        `Please verify the tool is connected to the vehicle’s OBD-II port and try again`,\n      title || 'Scan Failed'\n    );\n\n    this.isLeaveScanningPage = false;\n  }\n\n  async doCancelScanning() {\n    this.isCancelling = true;\n    this.resultText = '';\n    this.statusText = 'One moment please...';\n    this.isLeaveScanningPage = true;\n    return this.helper.popToRoot(RoutePath.Home).then(async () => {\n      if (AppState.isOnAndroid) {\n        console.log('Call this.ble.stopScan');\n        this.ble.stopScan();\n      }\n      await this.innovaVciService.disconnect(true, this.deviceId);\n    });\n  }\n\n  get isConnected() {\n    if (AppState.isOnDevice) {\n      return this.innovaVciService.isConnected;\n    }\n    return true;\n  }\n\n  async scanVin() {\n    let ctx = this;\n    if (ctx.isCancelling) {\n      return;\n    }\n    if (AppState.isOnDevice) {\n      ctx.barcodeScanner.scan({ orientation: 'portrait', prompt: '' }).then(\n        async (barcodeData) => {\n          if (barcodeData.cancelled) {\n            if (barcodeData.text && barcodeData.text === 'enterVin') {\n              await this.getVinFromUser();\n            } else {\n              this.cancel(false);\n            }\n          } else if (barcodeData) {\n            let vin = barcodeData.text;\n            if (\n              barcodeData.format === 'CODE_39' ||\n              (vin != '' && vin.length >= 17)\n            ) {\n              if (vin.length > 17) {\n                vin = vin.substring(1);\n              }\n              await this.decodeVIN(vin, true);\n            } else {\n              await ctx.helper.sleep(1000);\n              await ctx.scanVin();\n            }\n          }\n        },\n        async (err) => {\n          this.logger.debug(err);\n          await ctx.helper.sleep(1000);\n          await ctx.scanVin();\n        }\n      );\n    } else {\n      await this.getVinFromUser();\n    }\n  }\n\n  async decodeVIN(vin: string, needSetVIN = true) {\n    this.setStatus('', 'Decoding VIN: ' + vin);\n    this.#vehicleData = null;\n    let result = await this.vehicleService.decodeVin(vin);\n    if (result.success && result.data) {\n      if (needSetVIN) {\n        this.setStatus('', 'Writing VIN: ' + vin);\n      }\n      this.#vehicleData = result.data;\n      return await this.gotVIN(needSetVIN, vin);\n    } else {\n      if (result.message && result.message.code != -1) {\n        this.helper.alert(\n          result.message.code === 5006\n            ? `VIN ${vin} is invalid.`\n            : result.message.message,\n          'Error',\n          [\n            {\n              text: 'OK',\n              handler: () => {\n                this.cancel(false);\n              },\n            },\n          ]\n        );\n      } else {\n        const message =\n          'Unable to decode VIN: ' +\n          vin +\n          '. Please check your internet connection and try again.';\n        this.helper.confirm(\n          message,\n          'Error',\n          () => {\n            this.decodeVIN(vin, needSetVIN);\n          },\n          () => {\n            this.cancel();\n          },\n          'Retry',\n          'Cancel'\n        );\n      }\n    }\n  }\n\n  private async getVinFromUser() {\n    // if (this.isLeaveScanningPage) return;\n    const modal = await this.modalController.create({\n      component: EnterVinPage,\n      componentProps: {\n        isModal: true,\n      },\n    });\n    await modal.present();\n    const { data } = await modal.onDidDismiss();\n    this.setStatus('', 'Writing VIN: ' + data.vin);\n    this.#vehicleData = data.data;\n    return await this.gotVIN(true, data.vin);\n  }\n\n  private async onScanDone() {\n    if (this.isCancelling) {\n      this.logger.debug('isCancelling', this.isCancelling);\n      return;\n    }\n    let vciResponse = this.innovaVciService.vciResponseData;\n    this.logger.debug('vciResponseData', vciResponse);\n    let recentVin = localStorage.getItem(EnumLocalStorage.RecentVINScanned);\n    let recentMileage = 0;\n    if (\n      isNaN(vciResponse.mileage) ||\n      vciResponse.mileage <= 0 ||\n      vciResponse.mileage > MAX_MILEAGE_VALUE\n    ) {\n      if (recentVin && recentVin === vciResponse.vin) {\n        recentMileage = this.reportSession.mileage;\n      }\n      if (recentMileage && recentMileage > 0) {\n        vciResponse.mileage = recentMileage;\n        this.logger.debug(\n          'auto set mileage from recent user input',\n          recentMileage\n        );\n      }\n    }\n    if (this.connectedVehicle) {\n      this.connectedVehicle.vin = vciResponse.vin;\n      if (vciResponse.ymme) {\n        this.connectedVehicle.make = vciResponse.ymme.make;\n        this.connectedVehicle.year = vciResponse.ymme.year;\n        this.connectedVehicle.model = vciResponse.ymme.model;\n      }\n      this.connectedVehicle.mileage = vciResponse.mileage;\n      AppData.set(EnumAppDataKey.InfoVehicleConnected, this.connectedVehicle);\n    }\n    this.percent = 100;\n    await this.saveAndCreateReport(vciResponse, ReportStatus.Complete);\n  }\n\n  ionViewDidLeave() {\n    this.eventService.unsubscribe(InnovaVCIEvent.CONNECTED);\n    this.eventService.unsubscribe(InnovaVCIEvent.DEVICE_FOUND);\n    this.eventService.unsubscribe(InnovaVCIEvent.DEVICE_SELECTED);\n    this.eventService.unsubscribe(InnovaVCIEvent.SCAN_STATUS);\n    this.eventService.unsubscribe(InnovaVCIEvent.INTERRUPT_PROCESS);\n    this.eventService.unsubscribe(InnovaVCIEvent.USER_GUI_INFO);\n    if (this.multipleDevicesInterval) {\n      clearInterval(this.multipleDevicesInterval);\n      this.multipleDevicesInterval = null;\n    }\n    if (this.scanningTimeout) {\n      clearTimeout(this.scanningTimeout);\n      this.scanningTimeout = null;\n    }\n\n    this.isLeaveScanningPage = true;\n    // Unregister the custom back button action for this page\n    document.removeEventListener('backbutton', () => {\n      this.logger.debug('unregister back button event');\n    });\n  }\n\n  public initializeBackButtonCustomHandler(): void {\n    this.platform.ready().then(() => {\n      document.addEventListener('backbutton', () => {\n        this.customHandleBackButton();\n      });\n    });\n  }\n\n  private customHandleBackButton(): void {\n    this.cancel();\n  }\n\n  async cancel(confirm = true, reportFailed = false) {\n    if (AppState.isOnDevice) {\n      this.isCancelling = true;\n      if (confirm) {\n        this.helper.confirm(\n          'Are you sure?',\n          AppStrings.CONFIRM,\n          async () => {\n            this.doCancelScanning();\n          },\n          () => {\n            if (reportFailed) {\n              this.createReportFailed();\n            } else {\n              this.isCancelling = false;\n            }\n          }\n        );\n      } else {\n        this.doCancelScanning();\n      }\n    }\n  }\n}\n","<ion-content class=\"ion-padding\">\n  <div class=\"app-content-center-midle\">\n    <div class=\"text-center\" [hidden]=\"isScanning\" *ngIf=\"!hasMultipleDevices\">\n      <h2>{{title}} ...</h2>\n      <div class=\"app-spinner-wrap\">\n        <ion-spinner name=\"circles\"></ion-spinner>\n        <ion-icon src=\"assets/svg/car.svg\" class=\"font-size-80\"></ion-icon>\n      </div>\n      <p class=\"text-primary\">{{resultText}}</p>\n      <p class=\"text-danger\">{{statusText}}</p>\n      <p class=\"font-size-20\">This may take several minutes to complete.</p>\n      <ion-grid [hidden]=\"creatingReport\">\n        <ion-row>\n          <ion-col class=\"text-center\" (click)=\"cancel()\">\n            <a class=\"text-secondary font-size-18\">Cancel</a>\n          </ion-col>\n        </ion-row>\n      </ion-grid>\n    </div>\n\n    <div class=\"text-center\" [hidden]=\"!isScanning\" *ngIf=\"!hasMultipleDevices\">\n      <h2>Scanning devices...</h2>\n      <div class=\"app-spinner-wrap\">\n        <ion-spinner name=\"circles\" class=\"size-8\"></ion-spinner>\n      </div>\n      <p class=\"font-size-20 mb-5\">Starting scan</p>\n      <ion-grid>\n        <ion-row>\n          <ion-col class=\"text-center\" (click)=\"cancel()\">\n            <a class=\"text-secondary font-size-18\">Cancel</a>\n          </ion-col>\n        </ion-row>\n      </ion-grid>\n    </div>\n    <div class=\"text-center w-100 app-select-device-box px-3 py-4\" *ngIf=\"hasMultipleDevices\">\n      <h2 class=\"mb-5\">Please select device</h2>\n      <ion-button class=\"app-button mb-5\" expand=\"block\" *ngFor=\"let device of devices\" (click)=\"selectDevice(device)\">{{device.displayName}}</ion-button>\n      <ion-grid>\n        <ion-row>\n          <ion-col class=\"text-center\" (click)=\"cancel()\">\n            <a class=\"text-white font-size-18\">Cancel</a>\n          </ion-col>\n        </ion-row>\n      </ion-grid>\n    </div>\n  </div>\n</ion-content>\n"],"names":[],"sourceRoot":"webpack:///"}