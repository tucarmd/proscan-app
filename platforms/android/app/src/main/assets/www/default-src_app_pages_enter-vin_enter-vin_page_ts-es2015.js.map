{"version":3,"file":"default-src_app_pages_enter-vin_enter-vin_page_ts-es2015.js","mappings":"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","sources":["./src/app/pages/enter-vin/enter-vin.page.ts","./src/app/pages/enter-vin/enter-vin.page.html"],"sourcesContent":["import { Component, ViewChild } from '@angular/core';\nimport { FormControl, FormGroup, Validators } from '@angular/forms';\nimport { IonInput, ModalController, NavParams } from '@ionic/angular';\nimport { BaseController } from 'src/app/bases/base-controller';\nimport { ReportSession } from 'src/app/models/report-session';\nimport { HelperService } from 'src/app/services/helper.service';\nimport { ReportServiceProvider } from 'src/app/services/report-service/report-service';\nimport { AppState } from 'src/app/services/state/app.state';\nimport { ToolServiceProvider } from 'src/app/services/tool-service/tool-service';\nimport { VehicleServiceProvider } from 'src/app/services/vehicle-service/vehicle-service';\n\nexport const VIN_MAX_LENGTH = 17;\nconst DASH_CHARACTER = '-';\n@Component({\n  selector: 'app-enter-vin',\n  templateUrl: './enter-vin.page.html',\n  styleUrls: ['./enter-vin.page.scss'],\n})\nexport class EnterVinPage extends BaseController {\n  reportSession: ReportSession;\n  public isModal = false;\n  @ViewChild('vinInput') vinInput: IonInput;\n  public vinForm: FormGroup;\n  isLoading;\n  invalidVIN = false;\n  hasVIN = false;\n  isVehiclesNotFound = false;\n  vinLength = VIN_MAX_LENGTH;\n  constructor(public modal: ModalController,\n    public toolService: ToolServiceProvider,\n    public helper: HelperService,\n    public navParams: NavParams,\n    public reportService: ReportServiceProvider,\n    public vehicleService: VehicleServiceProvider) {\n      super('EnterVinPage');\n  }\n  \n  ngOnInit() {\n    this.vinForm = new FormGroup({\n      vin: new FormControl('', [Validators.required, Validators.maxLength(17)])\n    });\n  }\n\n  ionViewWillEnter(){\n    this.invalidVIN = false;\n    this.isVehiclesNotFound = false;\n    this.logger.debug(this.isModal);\n    this.reportSession = this.reportService.getReportSession();\n  }\n\n  ionViewDidEnter(){\n    setTimeout(() => {\n      this.vinInput.setFocus();\n    }, 1000);\n  }\n\n  async submit() {\n    this.hasVIN = false;\n    let vin = this.vinInput.value as string;\n    this.isLoading = true;\n    let re = new RegExp('[a-zA-Z0-9]{17}$');\n    let matches = vin.match(re);\n    if (matches && matches.length) {\n      vin = matches[0];\n      if (this.isModal) {\n        let result = await this.vehicleService.decodeVin(vin);\n        this.isLoading = false;\n        if (result.success) {\n          await this.modal.dismiss({ vin: vin, data: result.data});\n        }\n        else {\n          this.hasVIN = true;\n          this.isVehiclesNotFound = true;\n        }\n      } else {\n        let result = await this.vehicleService.getDlcLocationByVin(vin);\n        this.isLoading = false;\n        if (result.success) {\n          await this.modal.dismiss({ vin: vin, data: result.data});\n        }\n        else {\n          this.hasVIN = true;\n          this.isVehiclesNotFound = true;\n        }\n      }\n    } else {\n      this.hasVIN = true;\n      this.isLoading = false;\n      this.isVehiclesNotFound = true;\n    }\n  }\n\n  #formatVin(vin: string) {\n    if (vin) {\n      vin = vin.replace(/[^a-zA-Z0-9]/gi, '');\n      vin = vin.replace(/[qo]/gi, '0');\n      vin = vin.replace(/[i]/gi, '1');\n      vin = vin.slice(0, 17);\n      vin = vin.toUpperCase();\n    }\n    return vin;\n  }\n\n  async vinChanges(){\n    this.isVehiclesNotFound = false;\n    const vin: string = this.#formatVin(this.vinInput.value as string);\n    this.vinLength = VIN_MAX_LENGTH - vin.length;\n    this.vinInput.value = vin;\n    if(vin.length === VIN_MAX_LENGTH){\n      this.hasVIN = true;\n    } else {\n      this.hasVIN = false;\n    }\n  }\n\n  public close() {\n    this.modal.dismiss(null);\n  }\n}\n","<ion-header class=\"ion-no-border\">\n  <ion-toolbar mode=\"md\" *ngIf=\"isAndroid\">\n    <ion-title>Enter VIN</ion-title>\n    <ion-buttons slot=\"end\" [hidden]=\"isModal\">\n      <ion-button (click)=\"close()\">\n        <ion-icon name=\"close-outline\" class=\"font-size-28\"></ion-icon>\n      </ion-button>\n    </ion-buttons>\n  </ion-toolbar>\n  <ion-toolbar mode=\"ios\" *ngIf=\"!isAndroid\">\n    <ion-title>Enter VIN</ion-title>\n    <ion-buttons slot=\"end\" [hidden]=\"isModal\">\n      <ion-button (click)=\"close()\">\n        <ion-icon name=\"close-outline\" class=\"font-size-28\"></ion-icon>\n      </ion-button>\n    </ion-buttons>\n  </ion-toolbar>\n</ion-header>\n<ion-content class=\"ion-padding\">\n  <div class=\"app-content-center-midle\">\n    <div class=\"w-100 app-open-keybroad-01\" [formGroup]=\"vinForm\">\n      <h4>VIN ({{vinLength}})</h4>\n      <p class=\"mb-3\">\n        <ion-input (keyup.enter)=\"submit()\" inputmode=\"text\" maxlength=\"17\" class=\"app-input vin-input\" (ionChange)=\"vinChanges()\" #vinInput placeholder=\"*****************\"></ion-input>\n      </p>\n      <div class=\"mb-4 text-danger\" [hidden]=\"!invalidVIN\">\n        <span>VIN is required and must be 17 chars in length.</span>\n      </div>\n      <div class=\"mb-4 text-danger\" [hidden]=\"!isVehiclesNotFound\">\n        <span>Invalid VIN. Either this VIN is too new for our system, or our system cannot decode this VIN, or this VIN is invalid. Please enter a different VIN.</span>\n      </div>\n      <ion-button (click)=\"submit()\" class=\"app-button mt-2\" [disabled]=\"!hasVIN\" expand=\"block\">\n        <span [hidden]=\"isLoading\">Submit</span>\n        <ion-spinner [hidden]=\"!isLoading\"></ion-spinner>\n      </ion-button>\n    </div>\n  </div>\n</ion-content>\n"],"names":[],"sourceRoot":"webpack:///"}