{"version":3,"file":"src_app_pages_view-logs_view-logs_module_ts-es2015.js","mappings":"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","sources":["./src/app/bases/base-controller.ts","./src/app/pages/view-logs/view-logs-routing.module.ts","./src/app/pages/view-logs/view-logs.module.ts","./src/app/pages/view-logs/view-logs.page.ts","./src/app/pages/view-logs/view-logs.page.html"],"sourcesContent":["import { AppLogger, AppLoggerService } from '../services/logger';\nimport { ServiceInjector } from '../modules/service-injector.module';\nimport { AppState } from '../services/state/app.state';\nexport class BaseController {\n  protected readonly logger: AppLogger;\n  protected readonly serviceInjector = ServiceInjector;\n  protected readonly name: string;\n  public isAndroid: boolean;\n\n  constructor(name: string) {\n    this.name = name;// || this.constructor?.name;\n\n    const appLoggerService: AppLoggerService =\n    ServiceInjector.get(AppLoggerService);\n    this.logger = appLoggerService?.getLogger(this.name);\n    this.logger.debug('Enter');\n    this.isAndroid = AppState.isOnAndroid;\n  }\n}\n","import { NgModule } from '@angular/core';\nimport { Routes, RouterModule } from '@angular/router';\n\nimport { ViewLogsPage } from './view-logs.page';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: ViewLogsPage\n  }\n];\n\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule],\n})\nexport class ViewLogsPageRoutingModule {}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\n\nimport { IonicModule } from '@ionic/angular';\n\nimport { ViewLogsPageRoutingModule } from './view-logs-routing.module';\n\nimport { ViewLogsPage } from './view-logs.page';\n\n@NgModule({\n  imports: [\n    CommonModule,\n    FormsModule,\n    IonicModule,\n    ViewLogsPageRoutingModule\n  ],\n  declarations: [ViewLogsPage]\n})\nexport class ViewLogsPageModule {}\n","import { Component, OnInit } from '@angular/core';\nimport { NavController, NavParams } from '@ionic/angular';\nimport { AppConfig } from 'src/app/configs/app.config';\nimport { HelperService } from 'src/app/services/helper.service';\nimport { EmailComposer } from '@ionic-native/email-composer/ngx';\nimport { Device } from '@ionic-native/device/ngx';\nimport { File } from '@ionic-native/file/ngx';\nimport { BaseController } from 'src/app/bases/base-controller';\nimport { AppLoggerService } from 'src/app/services/logger';\nimport { LoggerConfig } from 'src/app/configs/logger.config';\nimport { AppState } from 'src/app/services/state/app.state';\nimport { RoutePath } from 'src/app/app-routing.module';\n@Component({\n  selector: 'app-view-logs',\n  templateUrl: './view-logs.page.html',\n  styleUrls: ['./view-logs.page.scss'],\n})\nexport class ViewLogsPage extends BaseController implements OnInit {\n  logs: any;\n  textLogs: any;\n  downloadLink: any;\n  constructor(\n    public navCtrl: NavController,\n    public navParams: NavParams,\n    public file: File,\n    public helper: HelperService,\n    public emailComposer: EmailComposer,\n    private appLoggerService: AppLoggerService,\n    private device: Device\n  ) {\n    super('ViewLogsPage');\n  }\n\n  ngOnInit() {}\n\n  ionViewWillEnter() {\n  }\n\n  ionViewDidEnter() {\n    this.downloadLink = null;\n    if (AppState.isOnDevice) {\n      let logs = this.appLoggerService\n        .getLogMessages()\n        .filter(\n          (e) => e.logger === LoggerConfig.bundleId\n          //e.timeStamp > CheckUpdateViewController.#startLogTime\n        )\n        .map((e) =>\n          [\n            new Date(e.timeStamp).toISOString(),\n            e.level,\n            e.methodName,\n            e.message,\n          ].join(' ')\n        )\n        .join('\\n');\n      this.textLogs = logs;\n      logs = logs.replace(/</g, '&lt;');\n      logs = logs.replace(/</g, '&gt;');\n      logs = logs.replace(/\\n/g, '<br/>');\n\n      this.logs = logs;\n    }\n  }\n\n  close() {\n    this.helper.popToRoot(RoutePath.Home);\n  }\n\n  clear() {\n    if (this.textLogs) {\n      this.helper.confirm(\n        'Are you sure to clear all logs?',\n        'Clear Logs',\n        () => {\n          this.appLoggerService.removeLogMessages();\n          this.logs = '';\n          this.textLogs = '';\n          this.downloadLink = null;\n          this.helper.alert('Log file has been cleared successfully!');\n        },\n        () => {}\n      );\n    } else {\n      this.helper.alert('No logs file available.');\n    }\n  }\n\n  download() {\n    if (this.textLogs) {\n      const filename = 'TestDrive-Log-Tool-' + new Date().getTime() + '.txt';\n      const logContent = this.textLogs;\n      try {\n        this.file\n          .writeFile(this.file.cacheDirectory, filename, logContent)\n          .then(async (data) => {\n            await this.onSuccess(data);\n          })\n          .catch((error) => {\n            this.onErr(error);\n          });\n      } catch (error) {\n        this.helper.alert(error);\n      }\n    } else {\n      this.helper.alert('No logs file available.');\n    }\n  }\n\n  async onSuccess(resp) {\n    try {\n      const deviceInfo =\n        'DEVICE INFO: ' +\n        '\\r\\n<br />- Cordova version: ' +\n        this.device.cordova +\n        '\\r\\n<br />- Model : ' +\n        this.device.model +\n        '\\r\\n<br />- Platform: ' +\n        this.device.platform +\n        '\\r\\n<br />- Version: ' +\n        this.device.version +\n        '\\r\\n<br />- Manufacturer: ' +\n        this.device.manufacturer +\n        '\\r\\n<br />- Serial: ' +\n        this.device.serial;\n      const email = {\n        to: AppConfig.LOGGER_EMAIL,\n        cc: AppConfig.LOGGER_CC_EMAIL,\n        attachments: ['base64:ProScan_2_Log.txt//' + btoa(this.textLogs)],\n        subject: 'ProScan 2.0 Logs ' + new Date().toISOString(),\n        body: deviceInfo,\n        isHtml: true,\n      };\n\n      // Send a text message using default options\n\n      try {\n        this.emailComposer.isAvailable().then((available: boolean) => {\n          this.logger.debug(resp.nativeURL);\n          this.logger.debug(available);\n          if (available) {\n            this.emailComposer.open(email).catch((error) => {\n              this.logger.debug(error);\n            });\n          } else {\n            this.helper.alert('Unable to send mail.');\n          }\n        });\n      } catch (error) {\n        this.logger.debug(error);\n      }\n    } catch (err) {\n      this.onErr(err);\n    }\n  }\n  onErr(resp) {\n    this.logger.debug(resp);\n    this.helper.alert('Cannot connect to server. Please try again.');\n  }\n\n  showDownloadPopup() {\n    if (this.downloadLink) {\n      this.helper.prompt(\n        'Please copy this url and open on your device, it will expired after access.',\n        'Download Logs File',\n        [{ name: 'url', value: this.downloadLink }]\n      );\n    } else {\n      this.download();\n    }\n  }\n}\n","<!--\n  Generated template for the ViewLogsPage page.\n\n  See http://ionicframework.com/docs/components/#navigation for more info on\n  Ionic pages and navigation.\n-->\n<ion-header class=\"ion-no-border\">\n  <ion-toolbar mode=\"md\" *ngIf=\"isAndroid\">\n    <ion-buttons slot=\"start\">\n      <ion-button (click)=\"close()\">\n        <ion-icon name=\"chevron-back-outline\" class=\"font-size-28\" color=\"primary\"></ion-icon>\n      </ion-button>\n    </ion-buttons>\n    <ion-title>View Logs</ion-title>\n    <ion-buttons slot=\"end\">\n      <ion-button (click)=\"showDownloadPopup()\">\n        <ion-icon name=\"download\" class=\"font-size-28\"></ion-icon>\n      </ion-button>\n      <ion-button (click)=\"clear()\">\n        <ion-icon name=\"trash\" class=\"font-size-28\"></ion-icon>\n      </ion-button>\n    </ion-buttons>\n  </ion-toolbar>\n  <ion-toolbar mode=\"ios\" *ngIf=\"!isAndroid\">\n    <ion-buttons slot=\"start\">\n      <ion-button (click)=\"close()\">\n        <ion-icon name=\"chevron-back-outline\" class=\"font-size-28\" color=\"primary\"></ion-icon>\n      </ion-button>\n    </ion-buttons>\n    <ion-title style=\"padding-left: 40px;\">View Logs</ion-title>\n    <ion-buttons slot=\"end\">\n      <ion-button (click)=\"showDownloadPopup()\">\n        <ion-icon name=\"download\" class=\"font-size-28\" color=\"light\"></ion-icon>\n      </ion-button>\n      <ion-button (click)=\"clear()\">\n        <ion-icon name=\"trash\" class=\"font-size-28\" color=\"light\"></ion-icon>\n      </ion-button>\n    </ion-buttons>\n  </ion-toolbar>\n</ion-header>\n\n<ion-content>\n  <div *ngIf=\"logs\" [innerHtml]=\"logs\">\n  </div>\n</ion-content>\n"],"names":[],"sourceRoot":"webpack:///"}