{"version":3,"mappings":"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","names":["BaseController","name","_modules_service_injector_module__WEBPACK_IMPORTED_MODULE_1__","appLoggerService","_services_logger__WEBPACK_IMPORTED_MODULE_0__","logger","getLogger","debug","isAndroid","_services_state_app_state__WEBPACK_IMPORTED_MODULE_2__","routes","path","component","_home_page__WEBPACK_IMPORTED_MODULE_0__","HomePageRoutingModule","_angular_router__WEBPACK_IMPORTED_MODULE_2__","imports","exports","HomePageModule","_angular_common__WEBPACK_IMPORTED_MODULE_3__","_angular_forms__WEBPACK_IMPORTED_MODULE_4__","_ionic_angular__WEBPACK_IMPORTED_MODULE_5__","_home_routing_module__WEBPACK_IMPORTED_MODULE_0__","declarations","_home_page__WEBPACK_IMPORTED_MODULE_1__","_angular_core__WEBPACK_IMPORTED_MODULE_15__","HomePage","platform","authService","helper","formBuilder","toolService","reportService","alertCtrl","network","openNativeSettings","navigationService","diagnostic","keyboard","src_app_configs_app_config__WEBPACK_IMPORTED_MODULE_1__","homeForm","group","workOrderNo","_angular_forms__WEBPACK_IMPORTED_MODULE_16__","mileage","src_app_services_state_user_state__WEBPACK_IMPORTED_MODULE_5__","popToRoot","src_app_app_routing_module__WEBPACK_IMPORTED_MODULE_0__","ready","then","isLoading","reportSession","getReportSession","softwareVersion","src_app_services_state_app_state__WEBPACK_IMPORTED_MODULE_4__","onKeyboardWillHide","subscribe","isKeyboardShow","onKeyboardWillShow","currentUser","firmwareVersion","localStorage","getItem","src_app_models_app_constant__WEBPACK_IMPORTED_MODULE_3__","checkBluetoothPermissions","logout","formSubmitted","goTo","event","ctx","type","confirm","create","header","message","buttons","text","role","handler","wait","doScanVehicle","present","workOrderNumber","value","saveReportSession","isBtEnabled","setBluetoothState","setTimeout","reset","goBack","switchToBluetoothSettings","open","ex","_a","info","removeItem","unregisterBackButtonAction","src_app_bases_base_controller__WEBPACK_IMPORTED_MODULE_2__","selectors","features","decls","vars","consts","template"],"sources":["webpack:///src/app/bases/base-controller.ts","webpack:///src/app/pages/home/home-routing.module.ts","webpack:///src/app/pages/home/home.module.ts","webpack:///src/app/pages/home/home.page.html","webpack:///src/app/pages/home/home.page.ts"],"sourcesContent":["import { AppLogger, AppLoggerService } from '../services/logger';\nimport { ServiceInjector } from '../modules/service-injector.module';\nimport { AppState } from '../services/state/app.state';\nexport class BaseController {\n  protected readonly logger: AppLogger;\n  protected readonly serviceInjector = ServiceInjector;\n  protected readonly name: string;\n  public isAndroid: boolean;\n\n  constructor(name: string) {\n    this.name = name;// || this.constructor?.name;\n\n    const appLoggerService: AppLoggerService =\n    ServiceInjector.get(AppLoggerService);\n    this.logger = appLoggerService?.getLogger(this.name);\n    this.logger.debug('Enter');\n    this.isAndroid = AppState.isOnAndroid;\n  }\n}\n","import { NgModule } from '@angular/core';\nimport { Routes, RouterModule } from '@angular/router';\n\nimport { HomePage } from './home.page';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: HomePage\n  }\n];\n\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule],\n})\nexport class HomePageRoutingModule {}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\n\nimport { IonicModule } from '@ionic/angular';\n\nimport { HomePageRoutingModule } from './home-routing.module';\n\nimport { HomePage } from './home.page';\nimport { ReactiveFormsModule } from '@angular/forms';\n@NgModule({\n  imports: [\n    CommonModule,\n    FormsModule,\n    ReactiveFormsModule,\n    IonicModule,\n    HomePageRoutingModule\n  ],\n  declarations: [HomePage]\n})\nexport class HomePageModule {}\n","<ion-content class=\"ion-padding\" scroll-y=\"false\">\n  <div class=\"app-content-center-midle\">\n    <div class=\"w-100 px-3\">\n      <form [formGroup]=\"homeForm\" (ngSubmit)=\"homeForm.valid && doScanVehicle($event)\">\n        <p class=\"app-form-logo\">\n          <img src=\"assets/img/its-logo.png\" alt=\"Innova Telematics Solutions\" />\n        </p>\n        <p class=\"mb-4\">\n          <ion-input class=\"app-input mb-2\" type=\"text\" placeholder=\"Work Order Number\" formControlName=\"workOrderNo\"\n            name=\"workOrderNo\" maxlength=\"10\"></ion-input>\n        </p>\n        <p class=\"mb-4\">\n          <ion-input formControlName=\"mileage\" class=\"app-input mb-2\" type=\"tel\" placeholder=\"Mileage\" pattern=\"[0-9]*\"\n            name=\"mileage\" maxlength=\"6\" required></ion-input>\n          <span *ngIf=\"formSubmitted\">\n            <span *ngIf=\"homeForm.controls.mileage.invalid\" class=\"text-danger\">Mileage is required.</span>\n          </span>\n        </p>\n        <p class=\"mb-4\">\n          <ion-button class=\"app-button\" expand=\"block\" type=\"submit\" [disabled]=\"isLoading\"\n            (click)=\"formSubmitted = true\">\n            <ion-spinner [hidden]=\"!isLoading\" class=\"app-sign-up-spinner\"></ion-spinner>\n            <span [hidden]=\"isLoading\" class=\"button-inner\">Start Scan</span>\n          </ion-button>\n        </p>\n        <p class=\"mb-4\">\n          <ion-button class=\"app-button\" expand=\"block\" (click)=\"viewPastReports()\">Past Reports</ion-button>\n        </p>\n      </form>\n\n      <div class=\"text-center\">\n        <p>\n          <a class=\"no-line font-size-16\" (click)=\"lookupDlc()\">Look up DLC?</a>\n        </p>\n        <p>\n          <a class=\"no-line font-size-16\" (click)=\"viewTutorial()\">Tutorial</a>\n        </p>\n        <p>\n          <a class=\"no-line font-size-16\" (click)=\"changeToolName()\">Change Tool Name</a>\n        </p>\n        <p>\n          <a class=\"no-line font-size-16\" (click)=\"viewLogs()\" *ngIf=\"isTesting\">View Logs</a>\n        </p>\n        <p *ngIf=\"softwareVersion\">\n          Software Version: {{softwareVersion}}\n        </p>\n        <p *ngIf=\"firmwareVersion\">\n          Firmware Version: {{firmwareVersion}}\n        </p>\n        <p *ngIf=\"isTesting\" class=\"mb-3\">Testing Version</p>\n      </div>\n    </div>\n  </div>\n</ion-content>\n\n<ion-footer class=\"ion-no-border p-2\">\n  <ion-toolbar class=\"py-1\" [hidden]=\"isKeyboardShow\">\n    <p class=\"text-center\" (click)=\"doLogout()\"><a class=\"no-line font-size-18\">Log Out</a></p>\n  </ion-toolbar>\n</ion-footer>","import { Component, OnInit } from '@angular/core';\nimport { FormBuilder, FormGroup, Validators } from '@angular/forms';\nimport { Network } from '@ionic-native/network/ngx';\nimport { AlertController, Platform } from '@ionic/angular';\nimport { RoutePath } from 'src/app/app-routing.module';\nimport { AppConfig, AppStrings } from 'src/app/configs/app.config';\nimport { ReportSession } from 'src/app/models/report-session';\nimport { HelperService } from 'src/app/services/helper.service';\nimport { AuthServiceProvider } from 'src/app/services/auth-service/auth-service';\nimport { ToolServiceProvider } from 'src/app/services/tool-service/tool-service';\nimport { ReportServiceProvider } from 'src/app/services/report-service/report-service';\nimport { Subscription } from 'rxjs';\nimport { NavigationService } from 'src/app/services/navigation.service';\nimport { Keyboard } from '@ionic-native/keyboard/ngx';\nimport { BaseController } from 'src/app/bases/base-controller';\nimport { StorageKeys } from 'src/app/models/app.constant';\nimport { AppState } from 'src/app/services/state/app.state';\nimport { User } from 'src/app/models/app.model';\nimport { UserState } from 'src/app/services/state/user.state';\nimport { Diagnostic } from '@ionic-native/diagnostic/ngx';\nimport { OpenNativeSettings } from '@ionic-native/open-native-settings/ngx';\n\n@Component({\n  selector: 'app-home',\n  templateUrl: './home.page.html',\n  styleUrls: ['./home.page.scss'],\n})\nexport class HomePage extends BaseController implements OnInit {\n  watchSub: Subscription;\n  homeForm: FormGroup;\n  formSubmitted: boolean = false;\n  currentUser: User;\n  softwareVersion: string;\n  firmwareVersion: string;\n  isKeyboardShow = false;\n  isLoading = false;\n  devices: Array<any> = [];\n  // Property used to store the callback of the event handler to unsubscribe to it when leaving this page\n  public unregisterBackButtonAction: any;\n  reportSession: ReportSession;\n  isTesting = AppConfig.isDevMode;\n  constructor(\n    private platform: Platform,\n    private authService: AuthServiceProvider,\n    private helper: HelperService,\n    private formBuilder: FormBuilder,\n    private toolService: ToolServiceProvider,\n    private reportService: ReportServiceProvider,\n    private alertCtrl: AlertController,\n    private network: Network,\n    private openNativeSettings: OpenNativeSettings,\n    private navigationService: NavigationService,\n    private diagnostic: Diagnostic,\n    private keyboard: Keyboard\n  ) {\n    super('HomePage');\n  }\n\n  ngOnInit() {\n    this.homeForm = this.formBuilder.group({\n      workOrderNo: ['', Validators.compose([Validators.maxLength(10)])],\n      mileage: [\n        '',\n        Validators.compose([\n          Validators.required,\n          Validators.minLength(1),\n          Validators.maxLength(9),\n        ]),\n      ],\n    });\n  }\n\n  async ionViewWillEnter() {\n    if (!UserState.isAuth) {\n      this.navigationService.popToRoot(RoutePath.Login);\n      return false;\n    }\n  }\n\n  async ionViewDidEnter() {\n    this.platform.ready().then(async () => {\n      this.isLoading = false;\n      if (UserState.isAuth) {\n        this.reportSession = this.reportService.getReportSession();\n        this.softwareVersion = AppState.isOnDevice ? AppState.appVersion : null;\n        this.keyboard.onKeyboardWillHide().subscribe(() => {\n          this.isKeyboardShow = false;\n        });\n        this.keyboard.onKeyboardWillShow().subscribe(() => {\n          this.isKeyboardShow = true;\n        });\n        this.currentUser = UserState.user;\n        this.firmwareVersion = localStorage.getItem(\n          StorageKeys.FIRMWARE_VERSION\n        );\n        this.helper.checkBluetoothPermissions();\n      } else {\n        this.authService.logout();\n        this.navigationService.popToRoot(RoutePath.Login);\n      }\n    });\n  }\n  viewTutorial() {\n    this.formSubmitted = false;\n    this.navigationService.goTo(RoutePath.Tutorial);\n  }\n\n  async doScanVehicle(event) {\n    let ctx = this;\n    if (ctx.formSubmitted) {\n      this.isLoading = true;\n      if (AppState.isOnDevice) {\n        if (ctx.network.type === 'none') {\n          let confirm = ctx.alertCtrl.create({\n            header: 'No Internet Connection',\n            message:\n              'Make sure Wi-Fi or cellular data is turned on, then try again.',\n            buttons: [\n              {\n                text: AppStrings.CANCEL,\n                role: 'cancel',\n                handler: () => {\n                  this.isLoading = false;\n                  this.logger.debug('Cancel clicked');\n                },\n              },\n              {\n                text: 'Retry',\n                handler: () => {\n                  this.logger.debug('Retry clicked');\n                  ctx.toolService.wait(100).then(() => {\n                    ctx.doScanVehicle(null);\n                  });\n                },\n              },\n            ],\n          });\n          await (await confirm).present();\n        } else {\n          this.reportSession.workOrderNumber = this.homeForm.value.workOrderNo;\n          this.reportSession.mileage = this.homeForm.value.mileage;\n          this.reportService.saveReportSession(this.reportSession);\n          ctx.formSubmitted = false;\n          this.logger.debug(\n            'Work Order Number:',\n            this.reportSession.workOrderNumber\n          );\n          this.logger.debug('Mileage:', this.reportSession.mileage);\n          // Check Bluetooth Permission\n          let isBtEnabled = await this.helper.checkBluetoothPermissions();\n          if(!isBtEnabled){\n            if(AppState.isOnAndroid && !AppState.isOnAtLeastVersion(13)){\n              this.helper.confirm('In order to detect and pair to your scan tool, please turn Bluetooth ON.', 'Bluetooth is turned OFF', async () =>{\n                isBtEnabled = await this.diagnostic.setBluetoothState(true);\n                this.logger.debug('Is BT Enabled', isBtEnabled);\n                if(isBtEnabled){\n                  setTimeout(() => {\n                    this.navigationService\n                      .goTo(RoutePath.VehicleLinking)\n                      .then(() => {\n                        ctx.isLoading = false;\n                        ctx.homeForm.reset();\n                      });\n                  }, 1_500);\n                } else {\n                  this.helper.goBack();\n                }\n              }, () => {\n                this.helper.goBack();\n              }, 'Turn Bluetooth ON', 'Cancel');\n            } else {\n              this.helper.confirm('In order to detect and pair to your scan tool, turn Bluetooth ON from your device’s settings.', 'Bluetooth is turned OFF', async () =>{\n                this.isLoading = false;\n                if(AppState.isOnAndroid){\n                  this.diagnostic.switchToBluetoothSettings();\n                } else {\n                  this.openNativeSettings.open('settings').catch((ex) => {\n                    this.logger?.info('openSettings>openNativeSettings>Error', ex);\n                  });\n                }\n              }, () => {\n                this.helper.goBack();\n              }, 'Go to settings', 'Cancel');\n            }\n          } else {\n            setTimeout(() => {\n              this.navigationService\n                .goTo(RoutePath.VehicleLinking)\n                .then(() => {\n                  ctx.isLoading = false;\n                  ctx.homeForm.reset();\n                });\n            }, 500);\n          }\n        }\n      }\n    }\n  }\n\n  doLogout() {\n    this.helper.confirm(\n      AppStrings.MSG_CONFIRM_LOGOUT,\n      AppStrings.CONFIRM,\n      () => {\n        this.authService.logout();\n        localStorage.removeItem(StorageKeys.USER_ID);\n        localStorage.removeItem(StorageKeys.ACCESS_KEY);\n        localStorage.removeItem(StorageKeys.USER_INFO);\n        localStorage.removeItem(StorageKeys.USER_SETTINGS);\n        localStorage.removeItem(StorageKeys.REPORT_SESSION);\n        this.helper.popToRoot(RoutePath.Login);\n      }\n    );\n  }\n\n  ionViewWillLeave() {\n    // Unregister the custom back button action for this page\n    this.unregisterBackButtonAction && this.unregisterBackButtonAction();\n  }\n  viewPastReports() {\n    this.formSubmitted = false;\n    this.navigationService.goTo(RoutePath.ReportHistory);\n  }\n\n  async viewLogs() {\n    this.formSubmitted = false;\n    this.navigationService.goTo(RoutePath.ViewLogs);\n  }\n\n  lookupDlc() {\n    this.formSubmitted = false;\n    this.navigationService.goTo(RoutePath.DlcLocator);\n  }\n\n  changeToolName() {\n    this.formSubmitted = false;\n    this.navigationService.goTo(RoutePath.ChangeToolName);\n  }\n}\n"]}